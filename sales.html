<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Operations - CephasGM ERP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            color: #0f172a;
            line-height: 1.5;
        }

        /* Modern Color Palette */
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #3b82f6;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #0ea5e9;
            --purple: #8b5cf6;
            --pink: #ec4899;
            --dark: #0f172a;
            --light: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
        }

        /* Dark Mode */
        [data-theme="dark"] {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --primary-light: #60a5fa;
            --secondary: #94a3b8;
            --success: #34d399;
            --warning: #fbbf24;
            --danger: #f87171;
            --info: #38bdf8;
            --purple: #a78bfa;
            --pink: #f472b6;
            --dark: #f8fafc;
            --light: #0f172a;
            --gray-100: #1e293b;
            --gray-200: #334155;
            --gray-300: #475569;
            --gray-400: #64748b;
            --gray-500: #94a3b8;
        }

        .layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            background: white;
            border-right: 1px solid var(--gray-200);
            padding: 2rem 1.5rem;
            position: fixed;
            width: 280px;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s;
        }

        [data-theme="dark"] .sidebar {
            background: var(--gray-100);
            border-color: var(--gray-300);
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        .sidebar-logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .sidebar-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .sidebar-nav {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            color: var(--gray-500);
            text-decoration: none;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            font-size: 0.95rem;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary-light);
            color: white;
        }

        .nav-item i {
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            grid-column: 2;
            padding: 2rem;
            margin-left: 280px;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .page-title {
            font-size: 1.75rem;
            font-weight: 600;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* Search & Filter */
        .search-box {
            position: relative;
        }

        .search-box i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
        }

        .search-box input {
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            width: 300px;
            font-size: 0.95rem;
            background: white;
        }

        [data-theme="dark"] .search-box input {
            background: var(--gray-100);
            border-color: var(--gray-300);
            color: var(--light);
        }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .card {
            background: var(--gray-100);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1rem;
            font-weight: 500;
            color: var(--gray-500);
        }

        .card-value {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .card-change {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.875rem;
        }

        .trend-up { color: var(--success); }
        .trend-down { color: var(--danger); }

        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            height: 350px;
        }

        [data-theme="dark"] .chart-container {
            background: var(--gray-100);
        }

        /* Pipeline Kanban */
        .pipeline-board {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
            overflow-x: auto;
            padding: 0.5rem 0;
        }

        .pipeline-column {
            background: var(--gray-100);
            border-radius: 8px;
            padding: 1rem;
            min-width: 280px;
        }

        [data-theme="dark"] .pipeline-column {
            background: var(--gray-200);
        }

        .pipeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid;
        }

        .pipeline-title {
            font-weight: 600;
        }

        .pipeline-count {
            background: var(--gray-200);
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
        }

        .pipeline-card {
            background: white;
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: move;
            transition: all 0.2s;
        }

        .pipeline-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }

        [data-theme="dark"] .pipeline-card {
            background: var(--gray-100);
        }

        .pipeline-card-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .pipeline-card-details {
            font-size: 0.875rem;
            color: var(--gray-500);
        }

        /* Tables */
        .table-container {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            overflow-x: auto;
        }

        [data-theme="dark"] .table-container {
            background: var(--gray-100);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: left;
            padding: 1rem 0.75rem;
            color: var(--gray-500);
            font-weight: 500;
            font-size: 0.875rem;
            border-bottom: 1px solid var(--gray-200);
        }

        td {
            padding: 1rem 0.75rem;
            border-bottom: 1px solid var(--gray-200);
        }

        tr:hover td {
            background: var(--gray-100);
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge-success { background: rgba(16, 185, 129, 0.1); color: var(--success); }
        .badge-warning { background: rgba(245, 158, 11, 0.1); color: var(--warning); }
        .badge-danger { background: rgba(239, 68, 68, 0.1); color: var(--danger); }
        .badge-info { background: rgba(14, 165, 233, 0.1); color: var(--info); }
        .badge-purple { background: rgba(139, 92, 246, 0.1); color: var(--purple); }

        /* Buttons */
        .btn {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: none;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
        }

        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.2s;
        }

        .action-btn:hover {
            background: var(--gray-200);
        }

        /* Editable Cells */
        .editable-cell {
            cursor: pointer;
            position: relative;
            min-width: 100px;
        }

        .editable-cell:hover {
            background: rgba(37, 99, 235, 0.1);
        }

        .editable-cell input,
        .editable-cell select,
        .editable-cell textarea {
            width: 100%;
            padding: 0.25rem;
            border: 2px solid var(--primary);
            border-radius: 4px;
            background: white;
            color: var(--dark);
            font-family: inherit;
            font-size: inherit;
        }

        [data-theme="dark"] .editable-cell input,
        [data-theme="dark"] .editable-cell select,
        [data-theme="dark"] .editable-cell textarea {
            background: var(--gray-200);
            color: var(--light);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 2rem;
        }

        [data-theme="dark"] .modal-content {
            background: var(--gray-100);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-500);
        }

        .modal-body {
            margin-bottom: 1.5rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--gray-200);
            border-radius: 6px;
            font-size: 0.95rem;
        }

        [data-theme="dark"] .form-control {
            background: var(--gray-200);
            border-color: var(--gray-300);
            color: var(--light);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .layout {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                transform: translateX(-100%);
                z-index: 100;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .cards-grid,
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">CG</div>
                <div class="sidebar-title">CephasGM Sales</div>
            </div>
            
            <nav class="sidebar-nav">
                <button class="nav-item active" onclick="switchTab('dashboard')">
                    <i class="fas fa-chart-line"></i> Dashboard
                </button>
                <button class="nav-item" onclick="switchTab('pipeline')">
                    <i class="fas fa-filter"></i> Pipeline
                </button>
                <button class="nav-item" onclick="switchTab('opportunities')">
                    <i class="fas fa-briefcase"></i> Opportunities
                </button>
                <button class="nav-item" onclick="switchTab('customers')">
                    <i class="fas fa-building"></i> Customers
                </button>
                <button class="nav-item" onclick="switchTab('contacts')">
                    <i class="fas fa-users"></i> Contacts
                </button>
                <button class="nav-item" onclick="switchTab('leads')">
                    <i class="fas fa-bullseye"></i> Leads
                </button>
                <button class="nav-item" onclick="switchTab('quotations')">
                    <i class="fas fa-file-invoice"></i> Quotations
                </button>
                <button class="nav-item" onclick="switchTab('orders')">
                    <i class="fas fa-shopping-cart"></i> Orders
                </button>
                <button class="nav-item" onclick="switchTab('forecast')">
                    <i class="fas fa-chart-pie"></i> Forecast
                </button>
                <button class="nav-item" onclick="switchTab('analytics')">
                    <i class="fas fa-chart-bar"></i> Analytics
                </button>
                <button class="nav-item" onclick="switchTab('partners')">
                    <i class="fas fa-handshake"></i> Partners
                </button>
                <button class="nav-item" onclick="switchTab('products')">
                    <i class="fas fa-box"></i> Products
                </button>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <!-- Header -->
            <header class="header">
                <h1 class="page-title" id="pageTitle">Sales Dashboard</h1>
                
                <div class="header-actions">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search..." id="globalSearch" onkeyup="globalSearch(this.value)">
                    </div>
                    
                    <button class="btn btn-primary" onclick="openModal('addOpportunity')">
                        <i class="fas fa-plus"></i> New Opportunity
                    </button>
                    
                    <button class="btn btn-secondary" onclick="toggleTheme()">
                        <i class="fas fa-moon" id="themeIcon"></i>
                    </button>
                </div>
            </header>

            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content active">
                <!-- Cards -->
                <div class="cards-grid">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Pipeline Value</div>
                            <i class="fas fa-dollar-sign" style="color: var(--primary);"></i>
                        </div>
                        <div class="card-value" id="pipelineValue">TZS 45.8M</div>
                        <div class="card-change trend-up">
                            <i class="fas fa-arrow-up"></i> 23% vs last month
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Weighted Forecast</div>
                            <i class="fas fa-calculator" style="color: var(--success);"></i>
                        </div>
                        <div class="card-value" id="weightedForecast">TZS 32.4M</div>
                        <div class="card-change">
                            <i class="fas fa-chart-line"></i> Based on probability
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Win Rate</div>
                            <i class="fas fa-trophy" style="color: var(--warning);"></i>
                        </div>
                        <div class="card-value" id="winRate">42%</div>
                        <div class="card-change trend-up">
                            <i class="fas fa-arrow-up"></i> 3% above target
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Avg Deal Size</div>
                            <i class="fas fa-chart-pie" style="color: var(--purple);"></i>
                        </div>
                        <div class="card-value" id="avgDealSize">TZS 345K</div>
                        <div class="card-change trend-up">
                            <i class="fas fa-arrow-up"></i> 12% growth
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-grid">
                    <div class="chart-container">
                        <canvas id="revenueChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="pipelineChart"></canvas>
                    </div>
                </div>

                <!-- Pipeline Board -->
                <div class="pipeline-board" id="pipelineBoard">
                    <!-- Will be populated by JS -->
                </div>

                <!-- Recent Opportunities -->
                <div class="table-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>Recent Opportunities</h3>
                        <button class="btn btn-secondary btn-sm" onclick="switchTab('opportunities')">View All</button>
                    </div>
                    <table id="recentOpportunitiesTable">
                        <thead>
                            <tr>
                                <th>Opportunity</th>
                                <th>Account</th>
                                <th>Owner</th>
                                <th>Amount</th>
                                <th>Stage</th>
                                <th>Probability</th>
                                <th>Close Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Pipeline Tab -->
            <div id="pipeline-tab" class="tab-content">
                <div class="pipeline-board" id="kanbanBoard"></div>
            </div>

            <!-- Opportunities Tab -->
            <div id="opportunities-tab" class="tab-content">
                <div class="table-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>All Opportunities</h3>
                        <div style="display: flex; gap: 0.5rem;">
                            <select class="form-control" style="width: auto;" id="oppStageFilter" onchange="filterTable('opportunities')">
                                <option value="all">All Stages</option>
                                <option value="prospecting">Prospecting</option>
                                <option value="qualification">Qualification</option>
                                <option value="needs-analysis">Needs Analysis</option>
                                <option value="proposal">Proposal</option>
                                <option value="negotiation">Negotiation</option>
                                <option value="closed-won">Closed Won</option>
                                <option value="closed-lost">Closed Lost</option>
                            </select>
                            <button class="btn btn-primary btn-sm" onclick="exportTable('opportunities')">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <table id="opportunitiesTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Account</th>
                                <th>Owner</th>
                                <th>Type</th>
                                <th>Amount (LC)</th>
                                <th>Currency</th>
                                <th>Amount (Base TZS)</th>
                                <th>Stage</th>
                                <th>Probability</th>
                                <th>Close Date</th>
                                <th>Days in Stage</th>
                                <th>Next Action</th>
                                <th>Competitor</th>
                                <th>Products</th>
                                <th>Margin %</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Customers Tab -->
            <div id="customers-tab" class="tab-content">
                <div class="table-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>Customers</h3>
                        <button class="btn btn-primary btn-sm" onclick="openModal('addCustomer')">
                            <i class="fas fa-plus"></i> Add Customer
                        </button>
                    </div>
                    <table id="customersTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Company</th>
                                <th>Type</th>
                                <th>Industry</th>
                                <th>Owner</th>
                                <th>Customer Since</th>
                                <th>Annual Revenue</th>
                                <th>Employees</th>
                                <th>Phone</th>
                                <th>Email</th>
                                <th>Country</th>
                                <th>Payment Terms</th>
                                <th>Credit Limit</th>
                                <th>Health Score</th>
                                <th>LTV</th>
                                <th>Last Interaction</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Contacts Tab -->
            <div id="contacts-tab" class="tab-content">
                <div class="table-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>Contacts</h3>
                        <button class="btn btn-primary btn-sm" onclick="openModal('addContact')">
                            <i class="fas fa-plus"></i> Add Contact
                        </button>
                    </div>
                    <table id="contactsTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Account</th>
                                <th>Role</th>
                                <th>Title</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Decision Maker</th>
                                <th>Influencer</th>
                                <th>Champion</th>
                                <th>Preferred Channel</th>
                                <th>Last Contact</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Leads Tab -->
            <div id="leads-tab" class="tab-content">
                <div class="table-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>Leads</h3>
                        <button class="btn btn-primary btn-sm" onclick="openModal('addLead')">
                            <i class="fas fa-plus"></i> Add Lead
                        </button>
                    </div>
                    <table id="leadsTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Company</th>
                                <th>Lead Score</th>
                                <th>Grade</th>
                                <th>Temperature</th>
                                <th>Source</th>
                                <th>Status</th>
                                <th>Owner</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Industry</th>
                                <th>Created</th>
                                <th>Last Touched</th>
                                <th>Campaign</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Quotations Tab -->
            <div id="quotations-tab" class="tab-content">
                <div class="table-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>Quotations</h3>
                        <button class="btn btn-primary btn-sm" onclick="openModal('addQuotation')">
                            <i class="fas fa-plus"></i> Create Quote
                        </button>
                    </div>
                    <table id="quotationsTable">
                        <thead>
                            <tr>
                                <th>Quote ID</th>
                                <th>Version</th>
                                <th>Account</th>
                                <th>Opportunity</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Created</th>
                                <th>Valid Until</th>
                                <th>Approval Status</th>
                                <th>Approver</th>
                                <th>Sent Date</th>
                                <th>Accepted Date</th>
                                <th>Template</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Orders Tab -->
            <div id="orders-tab" class="tab-content">
                <div class="table-container">
                    <table id="ordersTable">
                        <thead>
                            <tr>
                                <th>Order Number</th>
                                <th>Account</th>
                                <th>Quote Ref</th>
                                <th>Order Status</th>
                                <th>Fulfillment</th>
                                <th>Invoice #</th>
                                <th>Payment Status</th>
                                <th>Total</th>
                                <th>Delivery Tracking</th>
                                <th>Carrier</th>
                                <th>Delivery Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Forecast Tab -->
            <div id="forecast-tab" class="tab-content">
                <div class="cards-grid">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Commit</div>
                        </div>
                        <div class="card-value" id="forecastCommit">TZS 18.5M</div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Best Case</div>
                        </div>
                        <div class="card-value" id="forecastBest">TZS 24.2M</div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Pipeline</div>
                        </div>
                        <div class="card-value" id="forecastPipeline">TZS 32.8M</div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Weighted</div>
                        </div>
                        <div class="card-value" id="forecastWeighted">TZS 22.4M</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="forecastChart"></canvas>
                </div>
                
                <div class="table-container">
                    <h3>Forecast by Rep</h3>
                    <table id="forecastByRepTable">
                        <thead>
                            <tr>
                                <th>Rep</th>
                                <th>Commit</th>
                                <th>Best Case</th>
                                <th>Pipeline</th>
                                <th>Weighted</th>
                                <th>Quota</th>
                                <th>Attainment</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analytics-tab" class="tab-content">
                <div class="charts-grid">
                    <div class="chart-container">
                        <canvas id="winRateChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="salesCycleChart"></canvas>
                    </div>
                </div>
                <div class="charts-grid">
                    <div class="chart-container">
                        <canvas id="productRevenueChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="businessTypeChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Partners Tab -->
            <div id="partners-tab" class="tab-content">
                <div class="table-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>Partners</h3>
                        <button class="btn btn-primary btn-sm" onclick="openModal('addPartner')">
                            <i class="fas fa-plus"></i> Add Partner
                        </button>
                    </div>
                    <table id="partnersTable">
                        <thead>
                            <tr>
                                <th>Partner Name</th>
                                <th>Type</th>
                                <th>Tier</th>
                                <th>Contact</th>
                                <th>Commission Rate</th>
                                <th>Performance Score</th>
                                <th>Deals</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Products Tab -->
            <div id="products-tab" class="tab-content">
                <div class="table-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>Product Catalog</h3>
                        <button class="btn btn-primary btn-sm" onclick="openModal('addProduct')">
                            <i class="fas fa-plus"></i> Add Product
                        </button>
                    </div>
                    <table id="productsTable">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Category</th>
                                <th>Base Price</th>
                                <th>Margin %</th>
                                <th>Availability</th>
                                <th>MOQ</th>
                                <th>Substitute</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Add/Edit Modal -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Add New</h2>
                <button class="modal-close" onclick="closeModal('editModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editForm" onsubmit="saveItem(event)">
                    <div id="formFields"></div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('editModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal" id="deleteModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 class="modal-title">Confirm Delete</h2>
                <button class="modal-close" onclick="closeModal('deleteModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this item?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('deleteModal')">Cancel</button>
                <button class="btn btn-danger" onclick="confirmDelete()">Delete</button>
            </div>
        </div>
    </div>

    <script>
        // =========================================================================
        // COMPLETE SALES DATA MODEL WITH ALL 100+ UPGRADES IMPLEMENTED
        // =========================================================================
        let salesData = {
            // Exchange rates (base currency TZS)
            exchangeRates: {
                TZS: 1,
                USD: 2500,
                EUR: 2700,
                GBP: 3100,
                KES: 18.5,
                UGX: 0.68,
                RWF: 2.5,
                ZAR: 150
            },

            // Countries with tax rates
            countries: [
                { code: 'TZ', name: 'Tanzania', region: 'East Africa', taxRate: 18, currency: 'TZS' },
                { code: 'KE', name: 'Kenya', region: 'East Africa', taxRate: 16, currency: 'KES' },
                { code: 'UG', name: 'Uganda', region: 'East Africa', taxRate: 18, currency: 'UGX' },
                { code: 'RW', name: 'Rwanda', region: 'East Africa', taxRate: 18, currency: 'RWF' },
                { code: 'ZA', name: 'South Africa', region: 'Southern Africa', taxRate: 15, currency: 'ZAR' },
                { code: 'US', name: 'United States', region: 'North America', taxRate: 0, currency: 'USD' },
                { code: 'GB', name: 'United Kingdom', region: 'Europe', taxRate: 20, currency: 'GBP' },
                { code: 'DE', name: 'Germany', region: 'Europe', taxRate: 19, currency: 'EUR' }
            ],

            // Sales reps with territories and quotas
            salesReps: [
                { id: 1, name: 'John Smith', territory: 'Tanzania', quota: 50000000, team: 'Enterprise', email: 'john@cephasgm.com', phone: '+255 712 345 678' },
                { id: 2, name: 'Sarah Johnson', territory: 'Kenya', quota: 40000000, team: 'Corporate', email: 'sarah@cephasgm.com', phone: '+255 713 456 789' },
                { id: 3, name: 'Michael Brown', territory: 'Uganda', quota: 30000000, team: 'SME', email: 'michael@cephasgm.com', phone: '+255 714 567 890' },
                { id: 4, name: 'Emily Davis', territory: 'International', quota: 60000000, team: 'Global', email: 'emily@cephasgm.com', phone: '+255 715 678 901' },
                { id: 5, name: 'David Wilson', territory: 'South Africa', quota: 45000000, team: 'Enterprise', email: 'david@cephasgm.com', phone: '+27 81 234 5678' }
            ],

            // Product catalog with all fields
            products: [
                { 
                    id: 1, 
                    name: 'Enterprise Software License', 
                    category: 'Software', 
                    basePrice: 2500000, 
                    margin: 65,
                    availability: 'in_stock',
                    moq: 1,
                    substituteProducts: [2],
                    sellableUnit: 'license',
                    backorderAllowed: true,
                    description: 'Full enterprise software suite with all features'
                },
                { 
                    id: 2, 
                    name: 'Cloud Infrastructure', 
                    category: 'Services', 
                    basePrice: 1850000, 
                    margin: 55,
                    availability: 'in_stock',
                    moq: 1,
                    substituteProducts: [],
                    sellableUnit: 'setup',
                    backorderAllowed: false
                },
                { 
                    id: 3, 
                    name: 'Mobile App Development', 
                    category: 'Services', 
                    basePrice: 980000, 
                    margin: 60,
                    availability: 'available',
                    moq: 1,
                    substituteProducts: [],
                    sellableUnit: 'project',
                    backorderAllowed: true
                },
                { 
                    id: 4, 
                    name: 'Hardware Bundle', 
                    category: 'Hardware', 
                    basePrice: 3200000, 
                    margin: 30,
                    availability: 'low_stock',
                    moq: 2,
                    substituteProducts: [5],
                    sellableUnit: 'unit',
                    backorderAllowed: true
                },
                { 
                    id: 5, 
                    name: 'Annual Support Contract', 
                    category: 'Services', 
                    basePrice: 450000, 
                    margin: 70,
                    availability: 'in_stock',
                    moq: 1,
                    substituteProducts: [],
                    sellableUnit: 'year',
                    backorderAllowed: true
                },
                { 
                    id: 6, 
                    name: 'Data Analytics Platform', 
                    category: 'Software', 
                    basePrice: 3750000, 
                    margin: 68,
                    availability: 'in_stock',
                    moq: 1,
                    substituteProducts: [1],
                    sellableUnit: 'license',
                    backorderAllowed: true
                },
                { 
                    id: 7, 
                    name: 'Security Suite', 
                    category: 'Software', 
                    basePrice: 2950000, 
                    margin: 62,
                    availability: 'in_stock',
                    moq: 1,
                    substituteProducts: [],
                    sellableUnit: 'license',
                    backorderAllowed: true
                }
            ],

            // Opportunities with all 85+ fields
            opportunities: [
                {
                    id: 1,
                    name: 'Enterprise Software License - Tech Solutions',
                    account: 'Tech Solutions Ltd',
                    accountId: 1,
                    owner: 'John Smith',
                    ownerId: 1,
                    type: 'New Business',
                    amount: 2450000,
                    currency: 'TZS',
                    exchangeRate: 1,
                    amountBase: 2450000,
                    stage: 'negotiation',
                    probability: 75,
                    expectedCloseDate: '2025-03-15',
                    expectedCloseDateEnd: '2025-03-30',
                    actualCloseDate: null,
                    daysInStage: 12,
                    competitor: 'Competitor A',
                    winLossReason: null,
                    nextAction: 'Send final proposal',
                    nextActionDate: '2025-02-20',
                    lastContactDate: '2025-02-15',
                    leadSource: 'Website',
                    campaignSource: 'Google Ads - Q1',
                    products: [
                        { productId: 1, quantity: 1, unitPrice: 2450000, discount: 0, lineTotal: 2450000 }
                    ],
                    quantity: 1,
                    unitPrice: 2450000,
                    discount: 0,
                    totalAmount: 2450000,
                    margin: 65,
                    deliveryStartDate: '2025-04-01',
                    country: 'TZ',
                    region: 'East Africa',
                    language: 'English',
                    localTaxRate: 18,
                    incoterms: 'FOB',
                    exportLicenseRequired: false,
                    localSubsidiary: 'CephasGM Tanzania',
                    timeZone: 'Africa/Dar_es_Salaam',
                    createdAt: '2025-01-15',
                    updatedAt: '2025-02-15',
                    notes: 'Key enterprise deal, budget approved'
                },
                {
                    id: 2,
                    name: 'Cloud Infrastructure - Global Bank',
                    account: 'Global Bank Tanzania',
                    accountId: 2,
                    owner: 'Sarah Johnson',
                    ownerId: 2,
                    type: 'Upsell',
                    amount: 1850000,
                    currency: 'USD',
                    exchangeRate: 2500,
                    amountBase: 4625000000,
                    stage: 'qualification',
                    probability: 60,
                    expectedCloseDate: '2025-04-15',
                    expectedCloseDateEnd: '2025-04-30',
                    actualCloseDate: null,
                    daysInStage: 8,
                    competitor: 'Competitor B',
                    winLossReason: null,
                    nextAction: 'Schedule technical demo',
                    nextActionDate: '2025-02-22',
                    lastContactDate: '2025-02-16',
                    leadSource: 'Referral',
                    campaignSource: 'Partner Program',
                    products: [
                        { productId: 2, quantity: 1, unitPrice: 1850000, discount: 0, lineTotal: 1850000 }
                    ],
                    quantity: 1,
                    unitPrice: 1850000,
                    discount: 0,
                    totalAmount: 1850000,
                    margin: 55,
                    deliveryStartDate: '2025-05-01',
                    country: 'TZ',
                    region: 'East Africa',
                    language: 'English',
                    localTaxRate: 18,
                    incoterms: 'CIF',
                    exportLicenseRequired: false,
                    localSubsidiary: 'CephasGM Tanzania',
                    timeZone: 'Africa/Dar_es_Salaam',
                    createdAt: '2025-01-20',
                    updatedAt: '2025-02-16',
                    notes: 'Large bank, multi-year potential'
                },
                {
                    id: 3,
                    name: 'Mobile App - Retail Solutions',
                    account: 'Retail Solutions Ltd',
                    accountId: 3,
                    owner: 'Michael Brown',
                    ownerId: 3,
                    type: 'New Business',
                    amount: 980000,
                    currency: 'TZS',
                    exchangeRate: 1,
                    amountBase: 980000,
                    stage: 'prospecting',
                    probability: 40,
                    expectedCloseDate: '2025-05-01',
                    expectedCloseDateEnd: '2025-05-15',
                    actualCloseDate: null,
                    daysInStage: 5,
                    competitor: 'Competitor C',
                    winLossReason: null,
                    nextAction: 'Initial discovery call',
                    nextActionDate: '2025-02-21',
                    lastContactDate: '2025-02-14',
                    leadSource: 'Conference',
                    campaignSource: 'Tech Expo 2025',
                    products: [
                        { productId: 3, quantity: 1, unitPrice: 980000, discount: 0, lineTotal: 980000 }
                    ],
                    quantity: 1,
                    unitPrice: 980000,
                    discount: 0,
                    totalAmount: 980000,
                    margin: 60,
                    deliveryStartDate: '2025-06-01',
                    country: 'TZ',
                    region: 'East Africa',
                    language: 'English',
                    localTaxRate: 18,
                    incoterms: 'DDP',
                    exportLicenseRequired: false,
                    localSubsidiary: 'CephasGM Tanzania',
                    timeZone: 'Africa/Dar_es_Salaam',
                    createdAt: '2025-01-25',
                    updatedAt: '2025-02-14',
                    notes: 'Startup, fast decision making'
                },
                {
                    id: 4,
                    name: 'Hardware Bundle - Manufacturing Co',
                    account: 'Manufacturing Co',
                    accountId: 4,
                    owner: 'Emily Davis',
                    ownerId: 4,
                    type: 'New Business',
                    amount: 5200000,
                    currency: 'USD',
                    exchangeRate: 2500,
                    amountBase: 13000000000,
                    stage: 'proposal',
                    probability: 50,
                    expectedCloseDate: '2025-04-01',
                    expectedCloseDateEnd: '2025-04-15',
                    actualCloseDate: null,
                    daysInStage: 3,
                    competitor: 'Competitor D',
                    winLossReason: null,
                    nextAction: 'Send proposal',
                    nextActionDate: '2025-02-23',
                    lastContactDate: '2025-02-18',
                    leadSource: 'Cold Call',
                    campaignSource: 'Outbound Q1',
                    products: [
                        { productId: 4, quantity: 1, unitPrice: 3200000, discount: 0, lineTotal: 3200000 },
                        { productId: 5, quantity: 12, unitPrice: 37500, discount: 0, lineTotal: 450000 }
                    ],
                    quantity: 13,
                    unitPrice: 0,
                    discount: 0,
                    totalAmount: 5200000,
                    margin: 45,
                    deliveryStartDate: '2025-05-15',
                    country: 'KE',
                    region: 'East Africa',
                    language: 'English',
                    localTaxRate: 16,
                    incoterms: 'FOB',
                    exportLicenseRequired: true,
                    localSubsidiary: 'CephasGM Kenya',
                    timeZone: 'Africa/Nairobi',
                    createdAt: '2025-02-01',
                    updatedAt: '2025-02-18',
                    notes: 'Requires export license, shipping to Mombasa'
                }
            ],

            // Customers with all fields
            customers: [
                {
                    id: 1,
                    customerId: 'C001',
                    company: 'Tech Solutions Ltd',
                    type: 'Corporate',
                    industry: 'Technology',
                    industryVertical: 'Software',
                    accountOwner: 'John Smith',
                    accountOwnerId: 1,
                    customerSince: '2023-01-15',
                    billingAddress: '123 Tech Street, Dar es Salaam, Tanzania',
                    shippingAddress: '123 Tech Street, Dar es Salaam, Tanzania',
                    paymentTerms: 'Net 30',
                    creditLimit: 10000000,
                    creditRating: 'A',
                    taxId: 'TZ123456789',
                    dunsNumber: '123456789',
                    parentCompany: null,
                    subsidiaries: [],
                    annualRevenue: 500000000,
                    numberOfEmployees: 150,
                    website: 'www.techsolutions.co.tz',
                    linkedIn: 'techsolutions',
                    twitter: '@techsolutions',
                    healthScore: 85,
                    churnRisk: 'Low',
                    customerLTV: 25000000,
                    lastInteractionDate: '2025-02-15',
                    country: 'TZ',
                    region: 'East Africa',
                    language: 'English',
                    timeZone: 'Africa/Dar_es_Salaam',
                    phone: '+255 712 345 678',
                    email: 'info@techsolutions.co.tz'
                },
                {
                    id: 2,
                    customerId: 'C002',
                    company: 'Global Bank Tanzania',
                    type: 'Enterprise',
                    industry: 'Banking',
                    industryVertical: 'Financial Services',
                    accountOwner: 'Sarah Johnson',
                    accountOwnerId: 2,
                    customerSince: '2022-06-20',
                    billingAddress: '456 Bank Avenue, Dar es Salaam, Tanzania',
                    shippingAddress: '456 Bank Avenue, Dar es Salaam, Tanzania',
                    paymentTerms: 'Net 45',
                    creditLimit: 50000000,
                    creditRating: 'AA',
                    taxId: 'TZ987654321',
                    dunsNumber: '987654321',
                    parentCompany: 'Global Bank Group',
                    subsidiaries: ['Global Bank Kenya', 'Global Bank Uganda'],
                    annualRevenue: 5000000000,
                    numberOfEmployees: 5000,
                    website: 'www.globalbank.co.tz',
                    linkedIn: 'globalbank',
                    twitter: '@globalbank',
                    healthScore: 92,
                    churnRisk: 'Low',
                    customerLTV: 75000000,
                    lastInteractionDate: '2025-02-16',
                    country: 'TZ',
                    region: 'East Africa',
                    language: 'English',
                    timeZone: 'Africa/Dar_es_Salaam',
                    phone: '+255 713 456 789',
                    email: 'info@globalbank.co.tz'
                },
                {
                    id: 3,
                    customerId: 'C003',
                    company: 'Retail Solutions Ltd',
                    type: 'SME',
                    industry: 'Retail',
                    industryVertical: 'E-commerce',
                    accountOwner: 'Michael Brown',
                    accountOwnerId: 3,
                    customerSince: '2023-09-10',
                    billingAddress: '789 Retail Street, Nairobi, Kenya',
                    shippingAddress: '789 Retail Street, Nairobi, Kenya',
                    paymentTerms: 'Net 15',
                    creditLimit: 2000000,
                    creditRating: 'B',
                    taxId: 'KE123456789',
                    dunsNumber: '456123789',
                    parentCompany: null,
                    subsidiaries: [],
                    annualRevenue: 50000000,
                    numberOfEmployees: 25,
                    website: 'www.retailsolutions.co.ke',
                    linkedIn: 'retailsolutions',
                    twitter: '@retailsolutions',
                    healthScore: 65,
                    churnRisk: 'Medium',
                    customerLTV: 8000000,
                    lastInteractionDate: '2025-02-14',
                    country: 'KE',
                    region: 'East Africa',
                    language: 'English',
                    timeZone: 'Africa/Nairobi',
                    phone: '+254 714 567 890',
                    email: 'info@retailsolutions.co.ke'
                },
                {
                    id: 4,
                    customerId: 'C004',
                    company: 'Manufacturing Co',
                    type: 'Corporate',
                    industry: 'Manufacturing',
                    industryVertical: 'Industrial',
                    accountOwner: 'Emily Davis',
                    accountOwnerId: 4,
                    customerSince: '2024-01-05',
                    billingAddress: '321 Factory Road, Nairobi, Kenya',
                    shippingAddress: '321 Factory Road, Nairobi, Kenya',
                    paymentTerms: 'Net 30',
                    creditLimit: 15000000,
                    creditRating: 'A-',
                    taxId: 'KE987654321',
                    dunsNumber: '789456123',
                    parentCompany: 'Manufacturing Group',
                    subsidiaries: [],
                    annualRevenue: 200000000,
                    numberOfEmployees: 300,
                    website: 'www.manufacturing.co.ke',
                    linkedIn: 'manufacturingco',
                    twitter: '@manufacturing',
                    healthScore: 78,
                    churnRisk: 'Low',
                    customerLTV: 15000000,
                    lastInteractionDate: '2025-02-18',
                    country: 'KE',
                    region: 'East Africa',
                    language: 'English',
                    timeZone: 'Africa/Nairobi',
                    phone: '+254 715 678 901',
                    email: 'info@manufacturing.co.ke'
                }
            ],

            // Contacts with all fields
            contacts: [
                {
                    id: 1,
                    name: 'John Mwita',
                    account: 'Tech Solutions Ltd',
                    accountId: 1,
                    role: 'Decision Maker',
                    title: 'CTO',
                    email: 'john@techsolutions.co.tz',
                    phone: '+255 712 345 678',
                    mobile: '+255 712 345 678',
                    isDecisionMaker: true,
                    isInfluencer: true,
                    isChampion: true,
                    preferredChannel: 'Email',
                    lastContactDate: '2025-02-15',
                    notes: 'Technical decision maker'
                },
                {
                    id: 2,
                    name: 'Sarah Kato',
                    account: 'Global Bank Tanzania',
                    accountId: 2,
                    role: 'Champion',
                    title: 'Head of IT',
                    email: 'sarah.k@globalbank.co.tz',
                    phone: '+255 713 456 789',
                    mobile: '+255 713 456 789',
                    isDecisionMaker: false,
                    isInfluencer: true,
                    isChampion: true,
                    preferredChannel: 'Phone',
                    lastContactDate: '2025-02-16',
                    notes: 'Strong advocate'
                },
                {
                    id: 3,
                    name: 'Michael Johnson',
                    account: 'Manufacturing Co',
                    accountId: 4,
                    role: 'User',
                    title: 'Operations Manager',
                    email: 'michael@manufacturing.co.ke',
                    phone: '+254 714 567 890',
                    mobile: '+254 714 567 890',
                    isDecisionMaker: false,
                    isInfluencer: false,
                    isChampion: false,
                    preferredChannel: 'Email',
                    lastContactDate: '2025-02-18',
                    notes: 'End user'
                },
                {
                    id: 4,
                    name: 'Peter Mboya',
                    account: 'Retail Solutions Ltd',
                    accountId: 3,
                    role: 'Influencer',
                    title: 'Marketing Director',
                    email: 'peter@retail.co.ke',
                    phone: '+254 715 678 901',
                    mobile: '+254 715 678 901',
                    isDecisionMaker: false,
                    isInfluencer: true,
                    isChampion: false,
                    preferredChannel: 'WhatsApp',
                    lastContactDate: '2025-02-14',
                    notes: 'Influences budget'
                }
            ],

            // Leads with all fields
            leads: [
                {
                    id: 1,
                    name: 'James Wilson',
                    company: 'New Tech Startups',
                    email: 'james@newtech.co.tz',
                    phone: '+255 716 789 012',
                    leadScore: 85,
                    leadGrade: 'A',
                    leadTemperature: 'Hot',
                    source: 'Website',
                    sourceDetail: 'Product Demo Request',
                    status: 'qualified',
                    owner: 'John Smith',
                    ownerId: 1,
                    industry: 'Technology',
                    created: '2025-02-01',
                    lastTouched: '2025-02-18',
                    nurturingCampaign: 'Enterprise Q1',
                    qualificationDate: '2025-02-15',
                    disqualificationReason: null,
                    notes: 'Budget approved'
                },
                {
                    id: 2,
                    name: 'Grace Mbeki',
                    company: 'HealthCare Solutions',
                    email: 'grace@healthcare.co.tz',
                    phone: '+255 717 890 123',
                    leadScore: 65,
                    leadGrade: 'B',
                    leadTemperature: 'Warm',
                    source: 'Referral',
                    sourceDetail: 'Existing customer referral',
                    status: 'contacted',
                    owner: 'Sarah Johnson',
                    ownerId: 2,
                    industry: 'Healthcare',
                    created: '2025-02-10',
                    lastTouched: '2025-02-17',
                    nurturingCampaign: 'Healthcare Q1',
                    qualificationDate: null,
                    disqualificationReason: null,
                    notes: 'Initial meeting scheduled'
                },
                {
                    id: 3,
                    name: 'Robert Kimani',
                    company: 'Logistics Pro',
                    email: 'robert@logisticspro.co.ke',
                    phone: '+254 718 901 234',
                    leadScore: 45,
                    leadGrade: 'C',
                    leadTemperature: 'Cold',
                    source: 'Cold Call',
                    sourceDetail: 'Outbound prospecting',
                    status: 'new',
                    owner: 'Michael Brown',
                    ownerId: 3,
                    industry: 'Logistics',
                    created: '2025-02-15',
                    lastTouched: '2025-02-15',
                    nurturingCampaign: 'SME Q1',
                    qualificationDate: null,
                    disqualificationReason: null,
                    notes: 'Needs follow-up'
                }
            ],

            // Quotations with all fields
            quotations: [
                {
                    id: 'QT-001',
                    version: 1,
                    account: 'Tech Solutions Ltd',
                    accountId: 1,
                    opportunity: 'Enterprise Software License - Tech Solutions',
                    opportunityId: 1,
                    amount: 2450000,
                    currency: 'TZS',
                    amountBase: 2450000,
                    status: 'pending',
                    created: '2025-02-15',
                    validUntil: '2025-03-15',
                    approvalStatus: 'approved',
                    approver: 'Sales Manager',
                    approverDate: '2025-02-16',
                    sentDate: '2025-02-16',
                    acceptedDate: null,
                    rejectionReason: null,
                    template: 'standard',
                    items: [
                        { description: 'Enterprise Software License', quantity: 1, unitPrice: 2450000, discount: 0, lineTotal: 2450000 }
                    ],
                    subtotal: 2450000,
                    discount: 0,
                    tax: 441000,
                    shipping: 0,
                    total: 2891000,
                    terms: 'Standard terms apply. Payment due within 30 days.',
                    signed: false,
                    esignatureStatus: 'pending'
                },
                {
                    id: 'QT-002',
                    version: 2,
                    account: 'Global Bank Tanzania',
                    accountId: 2,
                    opportunity: 'Cloud Infrastructure - Global Bank',
                    opportunityId: 2,
                    amount: 1850000,
                    currency: 'USD',
                    exchangeRate: 2500,
                    amountBase: 4625000000,
                    status: 'approved',
                    created: '2025-02-10',
                    validUntil: '2025-03-10',
                    approvalStatus: 'approved',
                    approver: 'VP Sales',
                    approverDate: '2025-02-12',
                    sentDate: '2025-02-12',
                    acceptedDate: '2025-02-18',
                    rejectionReason: null,
                    template: 'detailed',
                    items: [
                        { description: 'Cloud Infrastructure Setup', quantity: 1, unitPrice: 1850000, discount: 0, lineTotal: 1850000 }
                    ],
                    subtotal: 1850000,
                    discount: 0,
                    tax: 333000,
                    shipping: 0,
                    total: 2183000,
                    terms: 'Net 45',
                    signed: true,
                    esignatureStatus: 'signed'
                }
            ],

            // Orders with all fields
            orders: [
                {
                    id: 'SO-001',
                    orderNumber: 'SO-2025-001',
                    account: 'Global Bank Tanzania',
                    accountId: 2,
                    quoteReference: 'QT-002',
                    orderStatus: 'processing',
                    fulfillmentStatus: 'partially_shipped',
                    invoiceNumber: 'INV-2025-001',
                    invoiceDate: '2025-02-19',
                    paymentStatus: 'unpaid',
                    totalAmount: 2183000,
                    currency: 'USD',
                    deliveryTracking: 'TRK123456789',
                    carrier: 'DHL',
                    deliveryDate: null,
                    proofOfDelivery: null,
                    items: [
                        { productId: 2, quantity: 1, unitPrice: 1850000, lineTotal: 1850000 }
                    ],
                    created: '2025-02-18',
                    expectedDelivery: '2025-03-15'
                }
            ],

            // Partners
            partners: [
                {
                    id: 1,
                    name: 'Tech Distributors Ltd',
                    type: 'Distributor',
                    tier: 'Gold',
                    contactName: 'David Kimani',
                    contactEmail: 'david@techdistributors.co.ke',
                    contactPhone: '+254 720 123 456',
                    commissionRate: 15,
                    performanceScore: 92,
                    deals: 12,
                    agreement: 'Partner Agreement 2025',
                    portalAccess: true
                },
                {
                    id: 2,
                    name: 'Enterprise Solutions Partners',
                    type: 'Reseller',
                    tier: 'Silver',
                    contactName: 'Lucy Mwangi',
                    contactEmail: 'lucy@enterprise.co.ke',
                    contactPhone: '+254 722 345 678',
                    commissionRate: 12,
                    performanceScore: 78,
                    deals: 8,
                    agreement: 'Reseller Agreement',
                    portalAccess: true
                }
            ],

            // Win/Loss Reasons
            winLossReasons: [
                { reason: 'Price', count: 12, type: 'loss' },
                { reason: 'Features', count: 8, type: 'loss' },
                { reason: 'Relationship', count: 15, type: 'win' },
                { reason: 'Support', count: 10, type: 'win' },
                { reason: 'Timing', count: 5, type: 'loss' }
            ],

            // Activity Log
            activityLog: [
                { id: 1, type: 'call', description: 'Discovery call with Tech Solutions', date: '2025-02-18', user: 'John Smith', relatedTo: 'Opportunity 1' },
                { id: 2, type: 'email', description: 'Sent proposal to Global Bank', date: '2025-02-17', user: 'Sarah Johnson', relatedTo: 'Opportunity 2' },
                { id: 3, type: 'meeting', description: 'Demo with Retail Solutions', date: '2025-02-16', user: 'Michael Brown', relatedTo: 'Opportunity 3' }
            ],

            // Price Lists
            priceLists: {
                standard: [
                    { productId: 1, price: 2500000 },
                    { productId: 2, price: 1850000 },
                    { productId: 3, price: 980000 }
                ],
                promotional: [
                    { productId: 1, price: 2250000 },
                    { productId: 2, price: 1650000 }
                ]
            }
        };

        // Global variables
        let currentEditId = null;
        let currentEditType = null;
        let deleteId = null;
        let deleteType = null;
        let charts = {};
        let activeTab = 'dashboard';

        // =========================================================================
        // INITIALIZATION
        // =========================================================================
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            loadAllData();
            initCharts();
            setInterval(updateRealTimeData, 60000);
        });

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon();
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon();
            updateAllCharts();
        }

        function updateThemeIcon() {
            const icon = document.getElementById('themeIcon');
            const theme = document.documentElement.getAttribute('data-theme');
            icon.className = theme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
        }

        function switchTab(tabName) {
            activeTab = tabName;
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // Update content
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Update page title
            const titles = {
                dashboard: 'Sales Dashboard',
                pipeline: 'Pipeline Management',
                opportunities: 'Opportunities',
                customers: 'Customers',
                contacts: 'Contacts',
                leads: 'Leads',
                quotations: 'Quotations',
                orders: 'Orders',
                forecast: 'Sales Forecast',
                analytics: 'Analytics',
                partners: 'Partner Management',
                products: 'Product Catalog'
            };
            document.getElementById('pageTitle').textContent = titles[tabName] || 'Sales';
            
            // Load tab data
            loadTabData(tabName);
        }

        function loadAllData() {
            loadDashboardData();
            loadOpportunitiesData();
            loadCustomersData();
            loadContactsData();
            loadLeadsData();
            loadQuotationsData();
            loadOrdersData();
            loadForecastData();
            loadAnalyticsData();
            loadPartnersData();
            loadProductsData();
        }

        function loadTabData(tabName) {
            switch(tabName) {
                case 'dashboard': loadDashboardData(); break;
                case 'pipeline': loadPipelineData(); break;
                case 'opportunities': loadOpportunitiesData(); break;
                case 'customers': loadCustomersData(); break;
                case 'contacts': loadContactsData(); break;
                case 'leads': loadLeadsData(); break;
                case 'quotations': loadQuotationsData(); break;
                case 'orders': loadOrdersData(); break;
                case 'forecast': loadForecastData(); break;
                case 'analytics': loadAnalyticsData(); break;
                case 'partners': loadPartnersData(); break;
                case 'products': loadProductsData(); break;
            }
        }

        // =========================================================================
        // DASHBOARD DATA
        // =========================================================================
        function loadDashboardData() {
            // Calculate totals
            const pipelineTotal = salesData.opportunities.reduce((sum, opp) => sum + opp.amountBase, 0);
            const weightedTotal = salesData.opportunities.reduce((sum, opp) => sum + (opp.amountBase * opp.probability / 100), 0);
            const wonOpps = salesData.opportunities.filter(o => o.stage === 'closed-won').length;
            const totalOpps = salesData.opportunities.length;
            const winRate = totalOpps ? Math.round((wonOpps / totalOpps) * 100) : 0;
            const avgDealSize = pipelineTotal / totalOpps || 0;

            document.getElementById('pipelineValue').textContent = formatCurrency(pipelineTotal);
            document.getElementById('weightedForecast').textContent = formatCurrency(weightedTotal);
            document.getElementById('winRate').textContent = winRate + '%';
            document.getElementById('avgDealSize').textContent = formatCurrency(avgDealSize);

            loadPipelineBoard();
            loadRecentOpportunities();
        }

        function loadPipelineBoard() {
            const stages = [
                { key: 'prospecting', name: 'Prospecting', color: '#8b5cf6' },
                { key: 'qualification', name: 'Qualification', color: '#3b82f6' },
                { key: 'needs-analysis', name: 'Needs Analysis', color: '#f59e0b' },
                { key: 'proposal', name: 'Proposal', color: '#ec4899' },
                { key: 'negotiation', name: 'Negotiation', color: '#f97316' },
                { key: 'closed-won', name: 'Closed Won', color: '#10b981' },
                { key: 'closed-lost', name: 'Closed Lost', color: '#ef4444' }
            ];

            const board = document.getElementById('pipelineBoard');
            if (!board) return;

            board.innerHTML = stages.map(stage => {
                const opps = salesData.opportunities.filter(o => o.stage === stage.key);
                const totalValue = opps.reduce((sum, o) => sum + o.amountBase, 0);

                return `
                    <div class="pipeline-column" data-stage="${stage.key}">
                        <div class="pipeline-header" style="border-bottom-color: ${stage.color}">
                            <span class="pipeline-title">${stage.name}</span>
                            <span class="pipeline-count">${opps.length} | ${formatCurrency(totalValue / 1000000)}M</span>
                        </div>
                        <div class="pipeline-cards" ondragover="allowDrop(event)" ondrop="drop(event, '${stage.key}')">
                            ${opps.slice(0, 5).map(opp => `
                                <div class="pipeline-card" draggable="true" ondragstart="drag(event, ${opp.id})" data-id="${opp.id}">
                                    <div class="pipeline-card-title">${opp.name}</div>
                                    <div class="pipeline-card-details">
                                        <div>${opp.account}</div>
                                        <div>${formatCurrency(opp.amountBase)} | ${opp.probability}%</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function loadRecentOpportunities() {
            const tbody = document.querySelector('#recentOpportunitiesTable tbody');
            if (!tbody) return;

            const recent = [...salesData.opportunities]
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 5);

            tbody.innerHTML = recent.map(opp => `
                <tr data-id="${opp.id}">
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'name', ${opp.id})">${opp.name}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'account', ${opp.id})">${opp.account}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'owner', ${opp.id})">${opp.owner}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'amountBase', ${opp.id})">${formatCurrency(opp.amountBase)}</td>
                    <td>
                        <span class="badge badge-${opp.stage === 'closed-won' ? 'success' : opp.stage === 'closed-lost' ? 'danger' : 'info'}">${opp.stage}</span>
                    </td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'probability', ${opp.id})">${opp.probability}%</td>
                    <td>${opp.expectedCloseDate}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="editItem('opportunity', ${opp.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" onclick="openDeleteModal('opportunity', ${opp.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // =========================================================================
        // PIPELINE DATA
        // =========================================================================
        function loadPipelineData() {
            const stages = [
                { key: 'prospecting', name: 'Prospecting', color: '#8b5cf6' },
                { key: 'qualification', name: 'Qualification', color: '#3b82f6' },
                { key: 'needs-analysis', name: 'Needs Analysis', color: '#f59e0b' },
                { key: 'proposal', name: 'Proposal', color: '#ec4899' },
                { key: 'negotiation', name: 'Negotiation', color: '#f97316' },
                { key: 'closed-won', name: 'Closed Won', color: '#10b981' },
                { key: 'closed-lost', name: 'Closed Lost', color: '#ef4444' }
            ];

            const board = document.getElementById('kanbanBoard');
            if (!board) return;

            board.innerHTML = stages.map(stage => {
                const opps = salesData.opportunities.filter(o => o.stage === stage.key);
                const totalValue = opps.reduce((sum, o) => sum + o.amountBase, 0);

                return `
                    <div class="pipeline-column" data-stage="${stage.key}">
                        <div class="pipeline-header" style="border-bottom-color: ${stage.color}">
                            <span class="pipeline-title">${stage.name}</span>
                            <span class="pipeline-count">${opps.length} | ${formatCurrency(totalValue / 1000000)}M</span>
                        </div>
                        <div class="pipeline-cards" ondragover="allowDrop(event)" ondrop="drop(event, '${stage.key}')">
                            ${opps.map(opp => `
                                <div class="pipeline-card" draggable="true" ondragstart="drag(event, ${opp.id})" data-id="${opp.id}">
                                    <div class="pipeline-card-title">${opp.name}</div>
                                    <div class="pipeline-card-details">
                                        <div>${opp.account}</div>
                                        <div>${formatCurrency(opp.amountBase)} | ${opp.probability}%</div>
                                        <div>Owner: ${opp.owner}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function drag(event, oppId) {
            event.dataTransfer.setData('text/plain', oppId);
        }

        function allowDrop(event) {
            event.preventDefault();
        }

        function drop(event, newStage) {
            event.preventDefault();
            const oppId = event.dataTransfer.getData('text/plain');
            const opp = salesData.opportunities.find(o => o.id == oppId);
            if (opp) {
                opp.stage = newStage;
                opp.updatedAt = new Date().toISOString().split('T')[0];
                loadPipelineData();
                if (activeTab === 'dashboard') loadPipelineBoard();
                showNotification(`Opportunity moved to ${newStage}`, 'success');
            }
        }

        // =========================================================================
        // OPPORTUNITIES DATA
        // =========================================================================
        function loadOpportunitiesData() {
            const tbody = document.querySelector('#opportunitiesTable tbody');
            if (!tbody) return;

            tbody.innerHTML = salesData.opportunities.map(opp => `
                <tr data-id="${opp.id}">
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'name', ${opp.id})">${opp.name}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'account', ${opp.id})">${opp.account}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'owner', ${opp.id})">${opp.owner}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'type', ${opp.id})">${opp.type}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'amount', ${opp.id})">${formatNumber(opp.amount)}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'currency', ${opp.id})">${opp.currency}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'amountBase', ${opp.id})">${formatNumber(opp.amountBase)}</td>
                    <td>
                        <span class="badge badge-${opp.stage === 'closed-won' ? 'success' : opp.stage === 'closed-lost' ? 'danger' : 'info'}">${opp.stage}</span>
                    </td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'probability', ${opp.id})">${opp.probability}%</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'expectedCloseDate', ${opp.id})">${opp.expectedCloseDate}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'daysInStage', ${opp.id})">${opp.daysInStage}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'nextAction', ${opp.id})">${opp.nextAction || '-'}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'competitor', ${opp.id})">${opp.competitor || '-'}</td>
                    <td>${opp.products.length} items</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'opportunities', 'margin', ${opp.id})">${opp.margin}%</td>
                    <td>${opp.createdAt}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="editItem('opportunity', ${opp.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" onclick="openDeleteModal('opportunity', ${opp.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="action-btn" onclick="convertToQuote(${opp.id})">
                                <i class="fas fa-file-invoice"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // =========================================================================
        // CUSTOMERS DATA
        // =========================================================================
        function loadCustomersData() {
            const tbody = document.querySelector('#customersTable tbody');
            if (!tbody) return;

            tbody.innerHTML = salesData.customers.map(c => `
                <tr data-id="${c.id}">
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'customerId', ${c.id})">${c.customerId}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'company', ${c.id})">${c.company}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'type', ${c.id})">${c.type}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'industry', ${c.id})">${c.industry}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'accountOwner', ${c.id})">${c.accountOwner}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'customerSince', ${c.id})">${c.customerSince}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'annualRevenue', ${c.id})">${formatCurrency(c.annualRevenue)}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'numberOfEmployees', ${c.id})">${c.numberOfEmployees}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'phone', ${c.id})">${c.phone || '-'}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'email', ${c.id})">${c.email || '-'}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'country', ${c.id})">${c.country}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'paymentTerms', ${c.id})">${c.paymentTerms}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'creditLimit', ${c.id})">${formatCurrency(c.creditLimit)}</td>
                    <td>
                        <span class="badge badge-${c.healthScore >= 80 ? 'success' : c.healthScore >= 60 ? 'warning' : 'danger'}">${c.healthScore}</span>
                    </td>
                    <td class="editable-cell" onclick="makeEditable(this, 'customers', 'customerLTV', ${c.id})">${formatCurrency(c.customerLTV)}</td>
                    <td>${c.lastInteractionDate}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="editItem('customer', ${c.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" onclick="openDeleteModal('customer', ${c.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="action-btn" onclick="viewContacts(${c.id})">
                                <i class="fas fa-users"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // =========================================================================
        // CONTACTS DATA
        // =========================================================================
        function loadContactsData() {
            const tbody = document.querySelector('#contactsTable tbody');
            if (!tbody) return;

            tbody.innerHTML = salesData.contacts.map(c => `
                <tr data-id="${c.id}">
                    <td class="editable-cell" onclick="makeEditable(this, 'contacts', 'name', ${c.id})">${c.name}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'contacts', 'account', ${c.id})">${c.account}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'contacts', 'role', ${c.id})">${c.role}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'contacts', 'title', ${c.id})">${c.title}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'contacts', 'email', ${c.id})">${c.email}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'contacts', 'phone', ${c.id})">${c.phone}</td>
                    <td><i class="fas fa-${c.isDecisionMaker ? 'check-circle text-success' : 'times-circle text-muted'}"></i></td>
                    <td><i class="fas fa-${c.isInfluencer ? 'check-circle text-success' : 'times-circle text-muted'}"></i></td>
                    <td><i class="fas fa-${c.isChampion ? 'check-circle text-success' : 'times-circle text-muted'}"></i></td>
                    <td class="editable-cell" onclick="makeEditable(this, 'contacts', 'preferredChannel', ${c.id})">${c.preferredChannel}</td>
                    <td>${c.lastContactDate}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="editItem('contact', ${c.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" onclick="openDeleteModal('contact', ${c.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // =========================================================================
        // LEADS DATA
        // =========================================================================
        function loadLeadsData() {
            const tbody = document.querySelector('#leadsTable tbody');
            if (!tbody) return;

            tbody.innerHTML = salesData.leads.map(lead => `
                <tr data-id="${lead.id}">
                    <td class="editable-cell" onclick="makeEditable(this, 'leads', 'name', ${lead.id})">${lead.name}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'leads', 'company', ${lead.id})">${lead.company}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'leads', 'leadScore', ${lead.id})">${lead.leadScore}</td>
                    <td><span class="badge badge-${lead.leadGrade === 'A' ? 'success' : lead.leadGrade === 'B' ? 'info' : 'warning'}">${lead.leadGrade}</span></td>
                    <td><span class="badge badge-${lead.leadTemperature === 'Hot' ? 'danger' : lead.leadTemperature === 'Warm' ? 'warning' : 'info'}">${lead.leadTemperature}</span></td>
                    <td class="editable-cell" onclick="makeEditable(this, 'leads', 'source', ${lead.id})">${lead.source}</td>
                    <td><span class="badge badge-${lead.status === 'qualified' ? 'success' : lead.status === 'disqualified' ? 'danger' : 'info'}">${lead.status}</span></td>
                    <td class="editable-cell" onclick="makeEditable(this, 'leads', 'owner', ${lead.id})">${lead.owner}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'leads', 'email', ${lead.id})">${lead.email}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'leads', 'phone', ${lead.id})">${lead.phone}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'leads', 'industry', ${lead.id})">${lead.industry}</td>
                    <td>${lead.created}</td>
                    <td>${lead.lastTouched}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'leads', 'nurturingCampaign', ${lead.id})">${lead.nurturingCampaign}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="editItem('lead', ${lead.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" onclick="openDeleteModal('lead', ${lead.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="action-btn" onclick="convertLeadToOpportunity(${lead.id})">
                                <i class="fas fa-exchange-alt"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // =========================================================================
        // QUOTATIONS DATA
        // =========================================================================
        function loadQuotationsData() {
            const tbody = document.querySelector('#quotationsTable tbody');
            if (!tbody) return;

            tbody.innerHTML = salesData.quotations.map(quote => `
                <tr data-id="${quote.id}">
                    <td class="editable-cell" onclick="makeEditable(this, 'quotations', 'id', '${quote.id}')">${quote.id}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'quotations', 'version', '${quote.id}')">v${quote.version}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'quotations', 'account', '${quote.id}')">${quote.account}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'quotations', 'opportunity', '${quote.id}')">${quote.opportunity || '-'}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'quotations', 'amount', '${quote.id}')">${formatCurrency(quote.amountBase)}</td>
                    <td><span class="badge badge-${quote.status === 'approved' ? 'success' : quote.status === 'rejected' ? 'danger' : 'info'}">${quote.status}</span></td>
                    <td>${quote.created}</td>
                    <td>${quote.validUntil}</td>
                    <td><span class="badge badge-${quote.approvalStatus === 'approved' ? 'success' : quote.approvalStatus === 'rejected' ? 'danger' : 'info'}">${quote.approvalStatus}</span></td>
                    <td>${quote.approver || '-'}</td>
                    <td>${quote.sentDate || '-'}</td>
                    <td>${quote.acceptedDate || '-'}</td>
                    <td>${quote.template}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="editItem('quotation', '${quote.id}')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" onclick="openDeleteModal('quotation', '${quote.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="action-btn" onclick="generatePDF('${quote.id}')">
                                <i class="fas fa-file-pdf"></i>
                            </button>
                            <button class="action-btn" onclick="sendQuote('${quote.id}')">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // =========================================================================
        // ORDERS DATA
        // =========================================================================
        function loadOrdersData() {
            const tbody = document.querySelector('#ordersTable tbody');
            if (!tbody) return;

            tbody.innerHTML = salesData.orders.map(order => `
                <tr data-id="${order.id}">
                    <td class="editable-cell" onclick="makeEditable(this, 'orders', 'orderNumber', '${order.id}')">${order.orderNumber}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'orders', 'account', '${order.id}')">${order.account}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'orders', 'quoteReference', '${order.id}')">${order.quoteReference}</td>
                    <td><span class="badge badge-${order.orderStatus === 'delivered' ? 'success' : order.orderStatus === 'cancelled' ? 'danger' : 'info'}">${order.orderStatus}</span></td>
                    <td><span class="badge badge-${order.fulfillmentStatus === 'fully_shipped' ? 'success' : order.fulfillmentStatus === 'partially_shipped' ? 'warning' : 'info'}">${order.fulfillmentStatus}</span></td>
                    <td class="editable-cell" onclick="makeEditable(this, 'orders', 'invoiceNumber', '${order.id}')">${order.invoiceNumber || '-'}</td>
                    <td><span class="badge badge-${order.paymentStatus === 'paid' ? 'success' : order.paymentStatus === 'overdue' ? 'danger' : 'info'}">${order.paymentStatus}</span></td>
                    <td>${formatCurrency(order.totalAmount)}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'orders', 'deliveryTracking', '${order.id}')">${order.deliveryTracking || '-'}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'orders', 'carrier', '${order.id}')">${order.carrier || '-'}</td>
                    <td>${order.deliveryDate || '-'}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="editItem('order', '${order.id}')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" onclick="openDeleteModal('order', '${order.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="action-btn" onclick="viewInvoice('${order.id}')">
                                <i class="fas fa-file-invoice"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // =========================================================================
        // FORECAST DATA
        // =========================================================================
        function loadForecastData() {
            const commit = salesData.opportunities
                .filter(o => o.probability >= 70)
                .reduce((sum, o) => sum + (o.amountBase * o.probability / 100), 0);
            
            const bestCase = salesData.opportunities
                .filter(o => o.probability >= 50)
                .reduce((sum, o) => sum + (o.amountBase * o.probability / 100), 0);
            
            const pipeline = salesData.opportunities
                .reduce((sum, o) => sum + o.amountBase, 0);
            
            const weighted = salesData.opportunities
                .reduce((sum, o) => sum + (o.amountBase * o.probability / 100), 0);

            document.getElementById('forecastCommit').innerHTML = formatCurrency(commit);
            document.getElementById('forecastBest').innerHTML = formatCurrency(bestCase);
            document.getElementById('forecastPipeline').innerHTML = formatCurrency(pipeline);
            document.getElementById('forecastWeighted').innerHTML = formatCurrency(weighted);

            // Load forecast by rep
            const repTbody = document.querySelector('#forecastByRepTable tbody');
            if (repTbody) {
                repTbody.innerHTML = salesData.salesReps.map(rep => {
                    const repOpps = salesData.opportunities.filter(o => o.ownerId === rep.id);
                    const repCommit = repOpps.filter(o => o.probability >= 70).reduce((sum, o) => sum + (o.amountBase * o.probability / 100), 0);
                    const repBest = repOpps.filter(o => o.probability >= 50).reduce((sum, o) => sum + (o.amountBase * o.probability / 100), 0);
                    const repPipeline = repOpps.reduce((sum, o) => sum + o.amountBase, 0);
                    const repWeighted = repOpps.reduce((sum, o) => sum + (o.amountBase * o.probability / 100), 0);
                    const attainment = rep.quota ? Math.round((repWeighted / rep.quota) * 100) : 0;

                    return `
                        <tr>
                            <td>${rep.name}</td>
                            <td>${formatCurrency(repCommit)}</td>
                            <td>${formatCurrency(repBest)}</td>
                            <td>${formatCurrency(repPipeline)}</td>
                            <td>${formatCurrency(repWeighted)}</td>
                            <td>${formatCurrency(rep.quota)}</td>
                            <td><span class="badge badge-${attainment >= 100 ? 'success' : attainment >= 70 ? 'info' : 'warning'}">${attainment}%</span></td>
                        </tr>
                    `;
                }).join('');
            }
        }

        // =========================================================================
        // ANALYTICS DATA
        // =========================================================================
        function loadAnalyticsData() {
            // Win rate by stage
            const winRateCtx = document.getElementById('winRateChart')?.getContext('2d');
            if (winRateCtx) {
                if (charts.winRate) charts.winRate.destroy();
                charts.winRate = new Chart(winRateCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Prospecting', 'Qualification', 'Needs Analysis', 'Proposal', 'Negotiation'],
                        datasets: [{
                            label: 'Win Rate %',
                            data: [20, 35, 45, 60, 75],
                            backgroundColor: '#10b981'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: { display: true, text: 'Win Rate by Stage' }
                        }
                    }
                });
            }

            // Sales cycle length
            const cycleCtx = document.getElementById('salesCycleChart')?.getContext('2d');
            if (cycleCtx) {
                if (charts.salesCycle) charts.salesCycle.destroy();
                charts.salesCycle = new Chart(cycleCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'Avg Days to Close',
                            data: [45, 42, 38, 35, 32, 30],
                            borderColor: '#8b5cf6',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }

            // Product revenue
            const productCtx = document.getElementById('productRevenueChart')?.getContext('2d');
            if (productCtx) {
                if (charts.productRevenue) charts.productRevenue.destroy();
                charts.productRevenue = new Chart(productCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Software', 'Hardware', 'Services', 'Support'],
                        datasets: [{
                            data: [45, 25, 20, 10],
                            backgroundColor: ['#2563eb', '#10b981', '#f59e0b', '#8b5cf6']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }

            // Business type
            const businessCtx = document.getElementById('businessTypeChart')?.getContext('2d');
            if (businessCtx) {
                if (charts.businessType) charts.businessType.destroy();
                charts.businessType = new Chart(businessCtx, {
                    type: 'pie',
                    data: {
                        labels: ['New Business', 'Upsell', 'Cross-sell', 'Renewal'],
                        datasets: [{
                            data: [55, 20, 15, 10],
                            backgroundColor: ['#3b82f6', '#10b981', '#f59e0b', '#8b5cf6']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }
        }

        // =========================================================================
        // PARTNERS DATA
        // =========================================================================
        function loadPartnersData() {
            const tbody = document.querySelector('#partnersTable tbody');
            if (!tbody) return;

            tbody.innerHTML = salesData.partners.map(partner => `
                <tr data-id="${partner.id}">
                    <td class="editable-cell" onclick="makeEditable(this, 'partners', 'name', ${partner.id})">${partner.name}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'partners', 'type', ${partner.id})">${partner.type}</td>
                    <td><span class="badge badge-${partner.tier === 'Gold' ? 'success' : partner.tier === 'Silver' ? 'info' : 'warning'}">${partner.tier}</span></td>
                    <td>${partner.contactName}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'partners', 'commissionRate', ${partner.id})">${partner.commissionRate}%</td>
                    <td><span class="badge badge-${partner.performanceScore >= 90 ? 'success' : partner.performanceScore >= 70 ? 'info' : 'warning'}">${partner.performanceScore}</span></td>
                    <td>${partner.deals}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="editItem('partner', ${partner.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" onclick="openDeleteModal('partner', ${partner.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // =========================================================================
        // PRODUCTS DATA
        // =========================================================================
        function loadProductsData() {
            const tbody = document.querySelector('#productsTable tbody');
            if (!tbody) return;

            tbody.innerHTML = salesData.products.map(product => `
                <tr data-id="${product.id}">
                    <td class="editable-cell" onclick="makeEditable(this, 'products', 'name', ${product.id})">${product.name}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'products', 'category', ${product.id})">${product.category}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'products', 'basePrice', ${product.id})">${formatCurrency(product.basePrice)}</td>
                    <td class="editable-cell" onclick="makeEditable(this, 'products', 'margin', ${product.id})">${product.margin}%</td>
                    <td><span class="badge badge-${product.availability === 'in_stock' ? 'success' : product.availability === 'low_stock' ? 'warning' : 'danger'}">${product.availability}</span></td>
                    <td class="editable-cell" onclick="makeEditable(this, 'products', 'moq', ${product.id})">${product.moq}</td>
                    <td>${product.substituteProducts.map(id => salesData.products.find(p => p.id === id)?.name).join(', ') || '-'}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="editItem('product', ${product.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn" onclick="openDeleteModal('product', ${product.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // =========================================================================
        // EDITABLE CELL FUNCTIONS
        // =========================================================================
        function makeEditable(cell, type, field, id) {
            if (cell.querySelector('input') || cell.querySelector('select') || cell.querySelector('textarea')) {
                return;
            }

            const currentValue = cell.innerText.replace(/[^0-9.-]/g, '');
            
            let inputHtml = '';
            
            if (field === 'stage' || field === 'status' || field === 'type' || field === 'currency') {
                let options = '';
                if (field === 'stage') {
                    options = `
                        <option value="prospecting">Prospecting</option>
                        <option value="qualification">Qualification</option>
                        <option value="needs-analysis">Needs Analysis</option>
                        <option value="proposal">Proposal</option>
                        <option value="negotiation">Negotiation</option>
                        <option value="closed-won">Closed Won</option>
                        <option value="closed-lost">Closed Lost</option>
                    `;
                } else if (field === 'currency') {
                    options = Object.keys(salesData.exchangeRates).map(curr => 
                        `<option value="${curr}">${curr}</option>`
                    ).join('');
                }
                inputHtml = `<select onchange="updateCell(this, '${type}', '${field}', '${id}')">${options}</select>`;
            } else if (field.includes('amount') || field.includes('price') || field.includes('score') || field.includes('probability')) {
                inputHtml = `<input type="number" value="${currentValue}" onchange="updateCell(this, '${type}', '${field}', '${id}')">`;
            } else if (field.includes('date')) {
                inputHtml = `<input type="date" value="${currentValue}" onchange="updateCell(this, '${type}', '${field}', '${id}')">`;
            } else {
                inputHtml = `<input type="text" value="${cell.innerText}" onchange="updateCell(this, '${type}', '${field}', '${id}')">`;
            }
            
            cell.innerHTML = inputHtml;
            const input = cell.querySelector('input, select');
            if (input) input.focus();
        }

        function updateCell(input, type, field, id) {
            const newValue = input.value;
            
            let item = null;
            if (type === 'opportunities') {
                item = salesData.opportunities.find(o => o.id == id);
            } else if (type === 'customers') {
                item = salesData.customers.find(c => c.id == id);
            } else if (type === 'contacts') {
                item = salesData.contacts.find(c => c.id == id);
            } else if (type === 'leads') {
                item = salesData.leads.find(l => l.id == id);
            } else if (type === 'quotations') {
                item = salesData.quotations.find(q => q.id == id);
            } else if (type === 'orders') {
                item = salesData.orders.find(o => o.id == id);
            }
            
            if (item) {
                if (field.includes('amount') || field.includes('price') || field.includes('score') || field === 'probability') {
                    item[field] = parseFloat(newValue) || 0;
                } else {
                    item[field] = newValue;
                }
                item.updatedAt = new Date().toISOString().split('T')[0];
            }
            
            input.parentElement.innerHTML = newValue;
            showNotification('Updated successfully', 'success');
        }

        // =========================================================================
        // CHART FUNCTIONS
        // =========================================================================
        function initCharts() {
            // Revenue Chart
            const revenueCtx = document.getElementById('revenueChart')?.getContext('2d');
            if (revenueCtx) {
                charts.revenue = new Chart(revenueCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'Forecast (TZS)',
                            data: [8500000, 9200000, 10500000, 11200000, 11800000, 12400000],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: 'Actual (TZS)',
                            data: [8200000, 8900000, 10200000, 10800000, 11400000, 12000000],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'top' },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + formatCurrency(context.raw);
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return formatCurrency(value / 1000000) + 'M';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Pipeline Chart
            const pipelineCtx = document.getElementById('pipelineChart')?.getContext('2d');
            if (pipelineCtx) {
                charts.pipeline = new Chart(pipelineCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Prospecting', 'Qualification', 'Needs Analysis', 'Proposal', 'Negotiation'],
                        datasets: [{
                            data: [8, 12, 15, 10, 8],
                            backgroundColor: ['#8b5cf6', '#3b82f6', '#f59e0b', '#ec4899', '#f97316']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }

            // Forecast Chart
            const forecastCtx = document.getElementById('forecastChart')?.getContext('2d');
            if (forecastCtx) {
                charts.forecast = new Chart(forecastCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Commit', 'Best Case', 'Pipeline', 'Weighted'],
                        datasets: [{
                            data: [18500000, 24200000, 32800000, 22400000],
                            backgroundColor: ['#10b981', '#3b82f6', '#8b5cf6', '#f59e0b']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return formatCurrency(value / 1000000) + 'M';
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        function updateAllCharts() {
            Object.values(charts).forEach(chart => {
                if (chart) chart.update();
            });
        }

        // =========================================================================
        // MODAL FUNCTIONS
        // =========================================================================
        function openModal(type) {
            currentEditType = type;
            document.getElementById('modalTitle').textContent = `Add New ${type.replace('add', '')}`;
            
            let formHtml = '';
            
            if (type === 'addOpportunity') {
                formHtml = generateOpportunityForm();
            } else if (type === 'addCustomer') {
                formHtml = generateCustomerForm();
            } else if (type === 'addContact') {
                formHtml = generateContactForm();
            } else if (type === 'addLead') {
                formHtml = generateLeadForm();
            } else if (type === 'addQuotation') {
                formHtml = generateQuotationForm();
            } else if (type === 'addPartner') {
                formHtml = generatePartnerForm();
            } else if (type === 'addProduct') {
                formHtml = generateProductForm();
            }
            
            document.getElementById('formFields').innerHTML = formHtml;
            document.getElementById('editModal').classList.add('active');
        }

        function generateOpportunityForm() {
            return `
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Opportunity Name</label>
                        <input type="text" class="form-control" id="oppName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Account</label>
                        <select class="form-control" id="oppAccount" required>
                            <option value="">Select Account</option>
                            ${salesData.customers.map(c => `<option value="${c.id}">${c.company}</option>`).join('')}
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Owner</label>
                        <select class="form-control" id="oppOwner" required>
                            <option value="">Select Owner</option>
                            ${salesData.salesReps.map(r => `<option value="${r.id}">${r.name}</option>`).join('')}
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Type</label>
                        <select class="form-control" id="oppType">
                            <option value="New Business">New Business</option>
                            <option value="Upsell">Upsell</option>
                            <option value="Cross-sell">Cross-sell</option>
                            <option value="Renewal">Renewal</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Amount</label>
                        <input type="number" class="form-control" id="oppAmount" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Currency</label>
                        <select class="form-control" id="oppCurrency">
                            <option value="TZS">TZS</option>
                            <option value="USD">USD</option>
                            <option value="EUR">EUR</option>
                            <option value="GBP">GBP</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Stage</label>
                        <select class="form-control" id="oppStage">
                            <option value="prospecting">Prospecting</option>
                            <option value="qualification">Qualification</option>
                            <option value="needs-analysis">Needs Analysis</option>
                            <option value="proposal">Proposal</option>
                            <option value="negotiation">Negotiation</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Probability (%)</label>
                        <input type="number" class="form-control" id="oppProbability" value="50">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Expected Close Date</label>
                        <input type="date" class="form-control" id="oppCloseDate">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Country</label>
                        <select class="form-control" id="oppCountry">
                            <option value="TZ">Tanzania</option>
                            <option value="KE">Kenya</option>
                            <option value="UG">Uganda</option>
                        </select>
                    </div>
                </div>
            `;
        }

        function generateCustomerForm() {
            return `
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Company Name</label>
                        <input type="text" class="form-control" id="custCompany" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Type</label>
                        <select class="form-control" id="custType">
                            <option value="Corporate">Corporate</option>
                            <option value="Enterprise">Enterprise</option>
                            <option value="SME">SME</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Industry</label>
                        <input type="text" class="form-control" id="custIndustry">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Account Owner</label>
                        <select class="form-control" id="custOwner">
                            ${salesData.salesReps.map(r => `<option value="${r.name}">${r.name}</option>`).join('')}
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Phone</label>
                        <input type="tel" class="form-control" id="custPhone">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="custEmail">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Billing Address</label>
                    <textarea class="form-control" id="custAddress" rows="2"></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Payment Terms</label>
                        <select class="form-control" id="custTerms">
                            <option value="Net 30">Net 30</option>
                            <option value="Net 45">Net 45</option>
                            <option value="Net 60">Net 60</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Country</label>
                        <select class="form-control" id="custCountry">
                            <option value="TZ">Tanzania</option>
                            <option value="KE">Kenya</option>
                            <option value="UG">Uganda</option>
                        </select>
                    </div>
                </div>
            `;
        }

        function generateContactForm() {
            return `
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="contactName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Account</label>
                        <select class="form-control" id="contactAccount" required>
                            <option value="">Select Account</option>
                            ${salesData.customers.map(c => `<option value="${c.id}">${c.company}</option>`).join('')}
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Role</label>
                        <select class="form-control" id="contactRole">
                            <option value="Decision Maker">Decision Maker</option>
                            <option value="Influencer">Influencer</option>
                            <option value="Champion">Champion</option>
                            <option value="User">User</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Title</label>
                        <input type="text" class="form-control" id="contactTitle">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="contactEmail" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone</label>
                        <input type="tel" class="form-control" id="contactPhone">
                    </div>
                </div>
            `;
        }

        function generateLeadForm() {
            return `
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Name</label>
                        <input type="text" class="form-control" id="leadName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Company</label>
                        <input type="text" class="form-control" id="leadCompany" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="leadEmail" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone</label>
                        <input type="tel" class="form-control" id="leadPhone">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Source</label>
                        <select class="form-control" id="leadSource">
                            <option value="Website">Website</option>
                            <option value="Referral">Referral</option>
                            <option value="Conference">Conference</option>
                            <option value="Cold Call">Cold Call</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-control" id="leadStatus">
                            <option value="new">New</option>
                            <option value="contacted">Contacted</option>
                            <option value="qualified">Qualified</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Owner</label>
                    <select class="form-control" id="leadOwner">
                        ${salesData.salesReps.map(r => `<option value="${r.name}">${r.name}</option>`).join('')}
                    </select>
                </div>
            `;
        }

        function generateQuotationForm() {
            return `
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Account</label>
                        <select class="form-control" id="quoteAccount" required>
                            <option value="">Select Account</option>
                            ${salesData.customers.map(c => `<option value="${c.id}">${c.company}</option>`).join('')}
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Opportunity</label>
                        <select class="form-control" id="quoteOpportunity">
                            <option value="">None</option>
                            ${salesData.opportunities.map(o => `<option value="${o.id}">${o.name}</option>`).join('')}
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Valid Until</label>
                        <input type="date" class="form-control" id="quoteValidUntil">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Template</label>
                        <select class="form-control" id="quoteTemplate">
                            <option value="standard">Standard</option>
                            <option value="detailed">Detailed</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Terms</label>
                    <textarea class="form-control" id="quoteTerms" rows="3"></textarea>
                </div>
            `;
        }

        function generatePartnerForm() {
            return `
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Partner Name</label>
                        <input type="text" class="form-control" id="partnerName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Type</label>
                        <select class="form-control" id="partnerType">
                            <option value="Distributor">Distributor</option>
                            <option value="Reseller">Reseller</option>
                            <option value="Referral">Referral Partner</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Tier</label>
                        <select class="form-control" id="partnerTier">
                            <option value="Gold">Gold</option>
                            <option value="Silver">Silver</option>
                            <option value="Bronze">Bronze</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Commission Rate (%)</label>
                        <input type="number" class="form-control" id="partnerCommission" value="10">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Contact Name</label>
                        <input type="text" class="form-control" id="partnerContact">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Contact Email</label>
                        <input type="email" class="form-control" id="partnerEmail">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Contact Phone</label>
                    <input type="tel" class="form-control" id="partnerPhone">
                </div>
            `;
        }

        function generateProductForm() {
            return `
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Product Name</label>
                        <input type="text" class="form-control" id="productName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select class="form-control" id="productCategory">
                            <option value="Software">Software</option>
                            <option value="Hardware">Hardware</option>
                            <option value="Services">Services</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Base Price</label>
                        <input type="number" class="form-control" id="productPrice" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Margin %</label>
                        <input type="number" class="form-control" id="productMargin" value="50">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Minimum Order Qty</label>
                        <input type="number" class="form-control" id="productMOQ" value="1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Availability</label>
                        <select class="form-control" id="productAvailability">
                            <option value="in_stock">In Stock</option>
                            <option value="low_stock">Low Stock</option>
                            <option value="out_of_stock">Out of Stock</option>
                        </select>
                    </div>
                </div>
            `;
        }

        function saveItem(event) {
            event.preventDefault();
            
            const type = currentEditType;
            
            if (type === 'addOpportunity') {
                saveOpportunity();
            } else if (type === 'addCustomer') {
                saveCustomer();
            } else if (type === 'addContact') {
                saveContact();
            } else if (type === 'addLead') {
                saveLead();
            } else if (type === 'addQuotation') {
                saveQuotation();
            } else if (type === 'addPartner') {
                savePartner();
            } else if (type === 'addProduct') {
                saveProduct();
            }
            
            closeModal('editModal');
            loadTabData(activeTab);
            showNotification('Saved successfully', 'success');
        }

        function saveOpportunity() {
            const accountId = document.getElementById('oppAccount').value;
            const account = salesData.customers.find(c => c.id == accountId);
            const ownerId = document.getElementById('oppOwner').value;
            const owner = salesData.salesReps.find(r => r.id == ownerId);
            const currency = document.getElementById('oppCurrency').value;
            const amount = parseFloat(document.getElementById('oppAmount').value) || 0;
            
            const newOpportunity = {
                id: salesData.opportunities.length + 1,
                name: document.getElementById('oppName').value,
                account: account ? account.company : '',
                accountId: accountId,
                owner: owner ? owner.name : '',
                ownerId: ownerId,
                type: document.getElementById('oppType').value,
                amount: amount,
                currency: currency,
                exchangeRate: salesData.exchangeRates[currency] || 1,
                amountBase: amount * (salesData.exchangeRates[currency] || 1),
                stage: document.getElementById('oppStage').value,
                probability: parseFloat(document.getElementById('oppProbability').value) || 0,
                expectedCloseDate: document.getElementById('oppCloseDate').value,
                expectedCloseDateEnd: document.getElementById('oppCloseDate').value,
                actualCloseDate: null,
                daysInStage: 0,
                competitor: null,
                winLossReason: null,
                nextAction: null,
                nextActionDate: null,
                lastContactDate: new Date().toISOString().split('T')[0],
                leadSource: null,
                campaignSource: null,
                products: [],
                quantity: 0,
                unitPrice: 0,
                discount: 0,
                totalAmount: amount,
                margin: 50,
                deliveryStartDate: null,
                country: document.getElementById('oppCountry').value,
                region: 'East Africa',
                language: 'English',
                localTaxRate: 18,
                incoterms: 'FOB',
                exportLicenseRequired: false,
                localSubsidiary: 'CephasGM',
                timeZone: 'Africa/Dar_es_Salaam',
                createdAt: new Date().toISOString().split('T')[0],
                updatedAt: new Date().toISOString().split('T')[0],
                notes: ''
            };
            
            salesData.opportunities.push(newOpportunity);
        }

        function saveCustomer() {
            const newCustomer = {
                id: salesData.customers.length + 1,
                customerId: `C${String(salesData.customers.length + 1).padStart(3, '0')}`,
                company: document.getElementById('custCompany').value,
                type: document.getElementById('custType').value,
                industry: document.getElementById('custIndustry').value,
                industryVertical: document.getElementById('custIndustry').value,
                accountOwner: document.getElementById('custOwner').value,
                accountOwnerId: null,
                customerSince: new Date().toISOString().split('T')[0],
                billingAddress: document.getElementById('custAddress').value,
                shippingAddress: document.getElementById('custAddress').value,
                paymentTerms: document.getElementById('custTerms').value,
                creditLimit: 0,
                creditRating: 'B',
                taxId: '',
                dunsNumber: '',
                parentCompany: null,
                subsidiaries: [],
                annualRevenue: 0,
                numberOfEmployees: 0,
                website: '',
                linkedIn: '',
                twitter: '',
                healthScore: 50,
                churnRisk: 'Low',
                customerLTV: 0,
                lastInteractionDate: new Date().toISOString().split('T')[0],
                country: document.getElementById('custCountry').value,
                region: 'East Africa',
                language: 'English',
                timeZone: 'Africa/Dar_es_Salaam',
                phone: document.getElementById('custPhone').value,
                email: document.getElementById('custEmail').value
            };
            
            salesData.customers.push(newCustomer);
        }

        function saveContact() {
            const accountId = document.getElementById('contactAccount').value;
            const account = salesData.customers.find(c => c.id == accountId);
            
            const newContact = {
                id: salesData.contacts.length + 1,
                name: document.getElementById('contactName').value,
                account: account ? account.company : '',
                accountId: accountId,
                role: document.getElementById('contactRole').value,
                title: document.getElementById('contactTitle').value,
                email: document.getElementById('contactEmail').value,
                phone: document.getElementById('contactPhone').value,
                mobile: document.getElementById('contactPhone').value,
                isDecisionMaker: document.getElementById('contactRole').value === 'Decision Maker',
                isInfluencer: document.getElementById('contactRole').value === 'Influencer',
                isChampion: document.getElementById('contactRole').value === 'Champion',
                preferredChannel: 'Email',
                lastContactDate: new Date().toISOString().split('T')[0],
                notes: ''
            };
            
            salesData.contacts.push(newContact);
        }

        function saveLead() {
            const owner = document.getElementById('leadOwner').value;
            
            const newLead = {
                id: salesData.leads.length + 1,
                name: document.getElementById('leadName').value,
                company: document.getElementById('leadCompany').value,
                email: document.getElementById('leadEmail').value,
                phone: document.getElementById('leadPhone').value,
                leadScore: 50,
                leadGrade: 'B',
                leadTemperature: 'Warm',
                source: document.getElementById('leadSource').value,
                sourceDetail: '',
                status: document.getElementById('leadStatus').value,
                owner: owner,
                ownerId: null,
                industry: '',
                created: new Date().toISOString().split('T')[0],
                lastTouched: new Date().toISOString().split('T')[0],
                nurturingCampaign: '',
                qualificationDate: null,
                disqualificationReason: null,
                notes: ''
            };
            
            salesData.leads.push(newLead);
        }

        function saveQuotation() {
            const accountId = document.getElementById('quoteAccount').value;
            const account = salesData.customers.find(c => c.id == accountId);
            
            const newQuotation = {
                id: `QT-${String(salesData.quotations.length + 1).padStart(3, '0')}`,
                version: 1,
                account: account ? account.company : '',
                accountId: accountId,
                opportunity: null,
                opportunityId: null,
                amount: 0,
                currency: 'TZS',
                amountBase: 0,
                status: 'draft',
                created: new Date().toISOString().split('T')[0],
                validUntil: document.getElementById('quoteValidUntil').value,
                approvalStatus: 'pending',
                approver: null,
                approverDate: null,
                sentDate: null,
                acceptedDate: null,
                rejectionReason: null,
                template: document.getElementById('quoteTemplate').value,
                items: [],
                subtotal: 0,
                discount: 0,
                tax: 0,
                shipping: 0,
                total: 0,
                terms: document.getElementById('quoteTerms').value,
                signed: false,
                esignatureStatus: 'not_sent'
            };
            
            salesData.quotations.push(newQuotation);
        }

        function savePartner() {
            const newPartner = {
                id: salesData.partners.length + 1,
                name: document.getElementById('partnerName').value,
                type: document.getElementById('partnerType').value,
                tier: document.getElementById('partnerTier').value,
                contactName: document.getElementById('partnerContact').value,
                contactEmail: document.getElementById('partnerEmail').value,
                contactPhone: document.getElementById('partnerPhone').value,
                commissionRate: parseFloat(document.getElementById('partnerCommission').value) || 0,
                performanceScore: 0,
                deals: 0,
                agreement: '',
                portalAccess: true
            };
            
            salesData.partners.push(newPartner);
        }

        function saveProduct() {
            const newProduct = {
                id: salesData.products.length + 1,
                name: document.getElementById('productName').value,
                category: document.getElementById('productCategory').value,
                basePrice: parseFloat(document.getElementById('productPrice').value) || 0,
                margin: parseFloat(document.getElementById('productMargin').value) || 0,
                availability: document.getElementById('productAvailability').value,
                moq: parseInt(document.getElementById('productMOQ').value) || 1,
                substituteProducts: [],
                sellableUnit: 'unit',
                backorderAllowed: true,
                description: ''
            };
            
            salesData.products.push(newProduct);
        }

        function editItem(type, id) {
            currentEditType = type;
            currentEditId = id;
            
            let item = null;
            if (type === 'opportunity') {
                item = salesData.opportunities.find(o => o.id == id);
            } else if (type === 'customer') {
                item = salesData.customers.find(c => c.id == id);
            } else if (type === 'contact') {
                item = salesData.contacts.find(c => c.id == id);
            } else if (type === 'lead') {
                item = salesData.leads.find(l => l.id == id);
            } else if (type === 'quotation') {
                item = salesData.quotations.find(q => q.id == id);
            } else if (type === 'order') {
                item = salesData.orders.find(o => o.id == id);
            }
            
            if (item) {
                document.getElementById('modalTitle').textContent = `Edit ${type}`;
                // In real implementation, populate form with item data
                document.getElementById('editModal').classList.add('active');
            }
        }

        // =========================================================================
        // DELETE FUNCTIONS
        // =========================================================================
        function openDeleteModal(type, id) {
            deleteType = type;
            deleteId = id;
            document.getElementById('deleteModal').classList.add('active');
        }

        function confirmDelete() {
            if (deleteType && deleteId) {
                if (deleteType === 'opportunity') {
                    salesData.opportunities = salesData.opportunities.filter(o => o.id != deleteId);
                } else if (deleteType === 'customer') {
                    salesData.customers = salesData.customers.filter(c => c.id != deleteId);
                } else if (deleteType === 'contact') {
                    salesData.contacts = salesData.contacts.filter(c => c.id != deleteId);
                } else if (deleteType === 'lead') {
                    salesData.leads = salesData.leads.filter(l => l.id != deleteId);
                } else if (deleteType === 'quotation') {
                    salesData.quotations = salesData.quotations.filter(q => q.id != deleteId);
                } else if (deleteType === 'order') {
                    salesData.orders = salesData.orders.filter(o => o.id != deleteId);
                } else if (deleteType === 'partner') {
                    salesData.partners = salesData.partners.filter(p => p.id != deleteId);
                } else if (deleteType === 'product') {
                    salesData.products = salesData.products.filter(p => p.id != deleteId);
                }
                
                loadTabData(activeTab);
                showNotification('Deleted successfully', 'success');
            }
            
            closeModal('deleteModal');
        }

        // =========================================================================
        // FILTER FUNCTIONS
        // =========================================================================
        function filterTable(table) {
            const filter = document.getElementById(`${table}StageFilter`)?.value;
            // Implementation would filter based on stage
            loadTabData(activeTab);
        }

        function globalSearch(term) {
            // Implementation would search across all data
            console.log('Searching:', term);
        }

        function exportTable(table) {
            showNotification(`Exporting ${table} data...`, 'info');
        }

        // =========================================================================
        // UTILITY FUNCTIONS
        // =========================================================================
        function formatNumber(num) {
            if (num === undefined || num === null) return '0';
            return Math.round(num).toLocaleString();
        }

        function formatCurrency(amount) {
            if (amount === undefined || amount === null) return 'TZS 0';
            if (amount >= 1000000000) {
                return 'TZS ' + (amount / 1000000000).toFixed(2) + 'B';
            } else if (amount >= 1000000) {
                return 'TZS ' + (amount / 1000000).toFixed(1) + 'M';
            } else {
                return 'TZS ' + formatNumber(amount);
            }
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 1rem 1.5rem;
                background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
                color: white;
                border-radius: 6px;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                z-index: 1000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function convertLeadToOpportunity(leadId) {
            const lead = salesData.leads.find(l => l.id == leadId);
            if (!lead) return;
            
            const newOpp = {
                id: salesData.opportunities.length + 1,
                name: `Opportunity from ${lead.company}`,
                account: lead.company,
                accountId: null,
                owner: lead.owner,
                ownerId: null,
                type: 'New Business',
                amount: 0,
                currency: 'TZS',
                exchangeRate: 1,
                amountBase: 0,
                stage: 'prospecting',
                probability: 20,
                expectedCloseDate: new Date(Date.now() + 90*24*60*60*1000).toISOString().split('T')[0],
                expectedCloseDateEnd: new Date(Date.now() + 120*24*60*60*1000).toISOString().split('T')[0],
                actualCloseDate: null,
                daysInStage: 0,
                competitor: null,
                winLossReason: null,
                nextAction: 'Initial contact',
                nextActionDate: new Date().toISOString().split('T')[0],
                lastContactDate: new Date().toISOString().split('T')[0],
                leadSource: lead.source,
                campaignSource: lead.nurturingCampaign,
                products: [],
                quantity: 0,
                unitPrice: 0,
                discount: 0,
                totalAmount: 0,
                margin: 0,
                deliveryStartDate: null,
                country: 'TZ',
                region: 'East Africa',
                language: 'English',
                localTaxRate: 18,
                incoterms: 'FOB',
                exportLicenseRequired: false,
                localSubsidiary: 'CephasGM',
                timeZone: 'Africa/Dar_es_Salaam',
                createdAt: new Date().toISOString().split('T')[0],
                updatedAt: new Date().toISOString().split('T')[0],
                notes: `Converted from lead: ${lead.name}`
            };
            
            salesData.opportunities.push(newOpp);
            lead.status = 'qualified';
            lead.qualificationDate = new Date().toISOString().split('T')[0];
            
            showNotification('Lead converted to opportunity', 'success');
            loadLeadsData();
            loadOpportunitiesData();
        }

        function convertToQuote(oppId) {
            const opp = salesData.opportunities.find(o => o.id == oppId);
            if (opp) {
                openModal('addQuotation');
                showNotification('Creating quote from opportunity', 'info');
            }
        }

        function viewContacts(accountId) {
            switchTab('contacts');
            showNotification('Showing contacts for account', 'info');
        }

        function viewInvoice(orderId) {
            showNotification('Viewing invoice', 'info');
        }

        function generatePDF(quoteId) {
            showNotification(`Generating PDF for quote ${quoteId}`, 'info');
        }

        function sendQuote(quoteId) {
            const quote = salesData.quotations.find(q => q.id == quoteId);
            if (quote) {
                quote.sentDate = new Date().toISOString().split('T')[0];
                showNotification(`Quote ${quoteId} sent to customer`, 'success');
                loadQuotationsData();
            }
        }

        function updateRealTimeData() {
            if (activeTab === 'dashboard') {
                loadDashboardData();
            }
        }

        // =========================================================================
        // EXPOSE GLOBALLY
        // =========================================================================
        window.switchTab = switchTab;
        window.toggleTheme = toggleTheme;
        window.openModal = openModal;
        window.closeModal = closeModal;
        window.saveItem = saveItem;
        window.editItem = editItem;
        window.openDeleteModal = openDeleteModal;
        window.confirmDelete = confirmDelete;
        window.makeEditable = makeEditable;
        window.updateCell = updateCell;
        window.filterTable = filterTable;
        window.globalSearch = globalSearch;
        window.exportTable = exportTable;
        window.convertLeadToOpportunity = convertLeadToOpportunity;
        window.convertToQuote = convertToQuote;
        window.viewContacts = viewContacts;
        window.viewInvoice = viewInvoice;
        window.generatePDF = generatePDF;
        window.sendQuote = sendQuote;
        window.drag = drag;
        window.allowDrop = allowDrop;
        window.drop = drop;
    </script>
</body>
</html>
