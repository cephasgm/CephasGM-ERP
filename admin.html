<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#003366">
  <title>CephasGM ‚Äì ERP | Administrator</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-192.png">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      margin: 0;
      background: linear-gradient(120deg, #f0f8ff, #e6f7ff);
      color: #333;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      background: #003366;
      color: white;
      padding: 15px 20px;
      text-align: left;
      font-size: 22px;
      font-weight: bold;
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .nav-back {
      color: white;
      text-decoration: none;
      font-size: 14px;
      font-weight: normal;
      background: rgba(255,255,255,0.2);
      padding: 5px 10px;
      border-radius: 4px;
      transition: background 0.3s;
    }
    .nav-back:hover {
      background: rgba(255,255,255,0.3);
    }
    header span { font-size: 16px; font-weight: normal; opacity: 0.8; }
    footer {
      background: #003366;
      color: white;
      text-align: center;
      padding: 10px 0;
      font-size: 14px;
      margin-top: auto;
    }
    .container { padding: 20px; flex: 1; overflow-x: auto; }
    h2 { text-align: left; color: #003366; margin-bottom: 10px; }
    
    .admin-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }
    
    .admin-card {
      background: white;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: all 0.3s;
      border-left: 5px solid #003366;
    }
    
    .admin-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    
    .admin-card h3 {
      color: #003366;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .admin-card p {
      color: #666;
      line-height: 1.5;
      margin-bottom: 15px;
    }
    
    .card-stats {
      display: flex;
      justify-content: space-between;
      color: #666;
      font-size: 0.9em;
    }
    
    .tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 2px solid #003366;
      flex-wrap: wrap;
    }
    
    .tab {
      padding: 12px 24px;
      cursor: pointer;
      background: #f8f9fa;
      border: none;
      border-bottom: 3px solid transparent;
      font-weight: 600;
      transition: all 0.3s;
    }
    
    .tab.active {
      background: white;
      border-bottom: 3px solid #003366;
      color: #003366;
    }
    
    .tab:hover {
      background: #e9ecef;
    }
    
    .tab-content {
      display: none;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    
    .tab-content.active {
      display: block;
    }
    
    table {
      border-collapse: collapse;
      width: 100%;
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    th, td {
      border: 1px solid #ccc;
      padding: 12px;
      text-align: left;
      font-size: 14px;
    }
    
    th {
      background: #003366;
      color: white;
      position: sticky;
      top: 0;
      z-index: 5;
    }
    
    tr:nth-child(even) { background: #f9f9f9; }
    
    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
      font-size: 0.9em;
    }
    
    .btn-primary { background: #003366; color: white; }
    .btn-success { background: #27ae60; color: white; }
    .btn-warning { background: #f39c12; color: white; }
    .btn-danger { background: #c0392b; color: white; }
    .btn-info { background: #2980b9; color: white; }
    
    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }
    
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      z-index: 200;
    }
    
    .modal-content {
      background: white;
      border-radius: 8px;
      padding: 20px;
      width: 90%;
      max-width: 500px;
      max-height: 80vh;
      overflow-y: auto;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .modal-header h3 {
      margin: 0;
      color: #003366;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #003366;
    }
    
    .form-group input, .form-group select, .form-group textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }
    
    .system-health {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .health-item {
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      text-align: center;
    }
    
    .health-status {
      font-size: 1.2em;
      font-weight: bold;
      margin-bottom: 5px;
    }
    
    .status-good { color: #27ae60; }
    .status-warning { color: #f39c12; }
    .status-error { color: #c0392b; }
  </style>
</head>
<body>
<header>
  <a href="index.html" class="nav-back">‚Üê Back to Dashboard</a>
  <div>CephasGM ‚Äì ERP <span>Administrator</span></div>
</header>

<div class="container">
  <div class="admin-grid">
    <div class="admin-card" onclick="switchTab('users')">
      <h3>üë• User Management</h3>
      <p>Manage system users, roles, and permissions. Create, edit, and deactivate user accounts.</p>
      <div class="card-stats">
        <span>Active Users: <strong id="activeUsers">0</strong></span>
        <span>Pending: <strong>2</strong></span>
      </div>
    </div>
    
    <div class="admin-card" onclick="switchTab('system')">
      <h3>‚öôÔ∏è System Settings</h3>
      <p>Configure system preferences, company information, and global application settings.</p>
      <div class="card-stats">
        <span>Modules: <strong>6</strong></span>
        <span>Last Backup: <strong>Today</strong></span>
      </div>
    </div>
    
    <div class="admin-card" onclick="switchTab('security')">
      <h3>üîí Security & Access</h3>
      <p>Manage security policies, access controls, audit logs, and data protection settings.</p>
      <div class="card-stats">
        <span>Active Sessions: <strong>5</strong></span>
        <span>Last Audit: <strong>2h ago</strong></span>
      </div>
    </div>
    
    <div class="admin-card" onclick="switchTab('backup')">
      <h3>üíæ Backup & Restore</h3>
      <p>Schedule automated backups, restore data, and manage system recovery procedures.</p>
      <div class="card-stats">
        <span>Last Backup: <strong>2GB</strong></span>
        <span>Storage: <strong>85%</strong></span>
      </div>
    </div>
    
    <div class="admin-card" onclick="switchTab('logs')">
      <h3>üìä System Logs</h3>
      <p>Monitor system activities, error logs, user actions, and performance metrics.</p>
      <div class="card-stats">
        <span>Today's Logs: <strong>1,247</strong></span>
        <span>Errors: <strong>2</strong></span>
      </div>
    </div>
    
    <div class="admin-card" onclick="switchTab('integration')">
      <h3>üîó Integrations</h3>
      <p>Manage third-party integrations, API connections, and external service configurations.</p>
      <div class="card-stats">
        <span>Active: <strong>3</strong></span>
        <span>Available: <strong>12</strong></span>
      </div>
    </div>
  </div>

  <h2>System Health</h2>
  <div class="system-health">
    <div class="health-item">
      <div class="health-status status-good">‚úì</div>
      <div>Application</div>
      <div>Running</div>
    </div>
    <div class="health-item">
      <div class="health-status status-good">‚úì</div>
      <div>Database</div>
      <div>Connected</div>
    </div>
    <div class="health-item">
      <div class="health-status status-warning">‚ö†Ô∏è</div>
      <div>Storage</div>
      <div>85% Used</div>
    </div>
    <div class="health-item">
      <div class="health-status status-good">‚úì</div>
      <div>Backup</div>
      <div>Completed</div>
    </div>
  </div>

  <div class="tabs">
    <button class="tab active" onclick="switchTab('users')">üë• Users</button>
    <button class="tab" onclick="switchTab('system')">‚öôÔ∏è System</button>
    <button class="tab" onclick="switchTab('security')">üîí Security</button>
    <button class="tab" onclick="switchTab('backup')">üíæ Backup</button>
    <button class="tab" onclick="switchTab('logs')">üìä Logs</button>
    <button class="tab" onclick="switchTab('integration')">üîó Integrations</button>
  </div>

  <div id="users" class="tab-content active">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <h3 style="margin: 0;">User Management</h3>
      <button class="btn btn-primary" onclick="openModal('addUser')">‚ûï Add User</button>
    </div>
    <table id="usersTable">
      <thead>
        <tr>
          <th>Username</th>
          <th>Full Name</th>
          <th>Email</th>
          <th>Role</th>
          <th>Department</th>
          <th>Status</th>
          <th>Last Login</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="system" class="tab-content">
    <h3>System Configuration</h3>
    <div class="admin-grid" style="grid-template-columns: 1fr 1fr;">
      <div class="admin-card">
        <h4>Company Information</h4>
        <form>
          <div class="form-group">
            <label>Company Name</label>
            <input type="text" value="CephasGM Ltd" readonly>
          </div>
          <div class="form-group">
            <label>Timezone</label>
            <select>
              <option>UTC+03:00 (East Africa Time)</option>
            </select>
          </div>
          <button class="btn btn-primary">Save Settings</button>
        </form>
      </div>
      <div class="admin-card">
        <h4>Module Settings</h4>
        <div class="form-group">
          <label>
            <input type="checkbox" checked> Payroll Module
          </label>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" checked> Attendance Module
          </label>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" checked> Meetings Module
          </label>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" checked> Finance Module
          </label>
        </div>
        <button class="btn btn-primary">Update Modules</button>
      </div>
    </div>
  </div>

  <div id="security" class="tab-content">
    <h3>Security Settings</h3>
    <div class="admin-grid" style="grid-template-columns: 1fr 1fr;">
      <div class="admin-card">
        <h4>Password Policy</h4>
        <div class="form-group">
          <label>Minimum Length</label>
          <input type="number" value="8" min="6">
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" checked> Require Special Characters
          </label>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" checked> Require Numbers
          </label>
        </div>
        <button class="btn btn-primary">Update Policy</button>
      </div>
      <div class="admin-card">
        <h4>Session Management</h4>
        <div class="form-group">
          <label>Session Timeout (minutes)</label>
          <input type="number" value="30" min="5">
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" checked> Allow Multiple Sessions
          </label>
        </div>
        <div class="form-group">
          <label>Max Login Attempts</label>
          <input type="number" value="5" min="3">
        </div>
        <button class="btn btn-primary">Save Settings</button>
      </div>
    </div>
  </div>

  <div id="backup" class="tab-content">
    <h3>Backup & Recovery</h3>
    <div class="admin-grid" style="grid-template-columns: 1fr 1fr;">
      <div class="admin-card">
        <h4>Manual Backup</h4>
        <p>Create an immediate backup of all system data.</p>
        <button class="btn btn-primary" onclick="createBackup()">üîÑ Create Backup Now</button>
        <div style="margin-top: 15px;">
          <strong>Last Backup:</strong> Today, 02:00 AM<br>
          <strong>Size:</strong> 1.8 GB<br>
          <strong>Status:</strong> Completed
        </div>
      </div>
      <div class="admin-card">
        <h4>Backup Schedule</h4>
        <div class="form-group">
          <label>Frequency</label>
          <select>
            <option>Daily</option>
            <option>Weekly</option>
            <option>Monthly</option>
          </select>
        </div>
        <div class="form-group">
          <label>Time</label>
          <input type="time" value="02:00">
        </div>
        <div class="form-group">
          <label>Retention Period (days)</label>
          <input type="number" value="30" min="7">
        </div>
        <button class="btn btn-primary">Save Schedule</button>
      </div>
    </div>
  </div>

  <div id="logs" class="tab-content">
    <h3>System Logs</h3>
    <table>
      <thead>
        <tr>
          <th>Timestamp</th>
          <th>User</th>
          <th>Action</th>
          <th>Module</th>
          <th>IP Address</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>2025-01-20 14:30:25</td>
          <td>admin</td>
          <td>Login</td>
          <td>Authentication</td>
          <td>192.168.1.100</td>
          <td><span class="status-good">Success</span></td>
        </tr>
        <tr>
          <td>2025-01-20 14:25:10</td>
          <td>user001</td>
          <td>Export Data</td>
          <td>Payroll</td>
          <td>192.168.1.101</td>
          <td><span class="status-good">Success</span></td>
        </tr>
        <tr>
          <td>2025-01-20 14:20:45</td>
          <td>user002</td>
          <td>Failed Login</td>
          <td>Authentication</td>
          <td>192.168.1.102</td>
          <td><span class="status-error">Failed</span></td>
        </tr>
      </tbody>
    </table>
  </div>

  <div id="integration" class="tab-content">
    <h3>Third-Party Integrations</h3>
    <div class="admin-grid" style="grid-template-columns: 1fr 1fr;">
      <div class="admin-card">
        <h4>üîó Google Workspace</h4>
        <p>Integrate with Google Calendar and Google Drive</p>
        <div class="form-group">
          <label>Status</label>
          <select>
            <option>Connected</option>
            <option>Disconnected</option>
          </select>
        </div>
        <button class="btn btn-primary">Configure</button>
      </div>
      <div class="admin-card">
        <h4>üí≥ Payment Gateway</h4>
        <p>Connect with payment processors</p>
        <div class="form-group">
          <label>Provider</label>
          <select>
            <option>Stripe</option>
            <option>PayPal</option>
          </select>
        </div>
        <button class="btn btn-primary">Setup</button>
      </div>
    </div>
  </div>
</div>

<footer>Copyright ¬© 2025 üòÄ</footer>

<!-- Add User Modal -->
<div id="addUserModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Add New User</h3>
      <button onclick="closeModal('addUser')">‚úñ</button>
    </div>
    <form id="userForm" onsubmit="saveUser(event)">
      <div class="form-group">
        <label for="userUsername">Username</label>
        <input type="text" id="userUsername" required>
      </div>
      <div class="form-group">
        <label for="userFullName">Full Name</label>
        <input type="text" id="userFullName" required>
      </div>
      <div class="form-group">
        <label for="userEmail">Email</label>
        <input type="email" id="userEmail" required>
      </div>
      <div class="form-group">
        <label for="userRole">Role</label>
        <select id="userRole" required>
          <option value="admin">Administrator</option>
          <option value="manager">Manager</option>
          <option value="user">Standard User</option>
          <option value="viewer">Viewer</option>
        </select>
      </div>
      <div class="form-group">
        <label for="userDepartment">Department</label>
        <input type="text" id="userDepartment" required>
      </div>
      <div class="form-group">
        <label for="userPassword">Temporary Password</label>
        <input type="password" id="userPassword" required>
      </div>
      <div style="text-align:center; margin-top:15px;">
        <button class="btn btn-success" type="submit">Create User</button>
        <button class="btn" type="button" onclick="closeModal('addUser')">Cancel</button>
      </div>
    </form>
  </div>
</div>

<script>
let users = JSON.parse(localStorage.getItem('adminUsers') || '[]');

// Initialize with sample users if empty
if (users.length === 0) {
  users = [
    {
      id: 1,
      username: 'admin',
      fullName: 'System Administrator',
      email: 'admin@cephasgm.com',
      role: 'admin',
      department: 'IT',
      status: 'active',
      lastLogin: '2025-01-20 14:30:25'
    }
  ];
  localStorage.setItem('adminUsers', JSON.stringify(users));
}

function openModal(type) {
  document.getElementById(type + 'Modal').style.display = 'flex';
}

function closeModal(type) {
  document.getElementById(type + 'Modal').style.display = 'none';
}

function switchTab(tabName) {
  // Hide all tab contents
  document.querySelectorAll('.tab-content').forEach(tab => {
    tab.classList.remove('active');
  });
  
  // Remove active class from all tabs
  document.querySelectorAll('.tab').forEach(tab => {
    tab.classList.remove('active');
  });
  
  // Show selected tab content and activate tab
  document.getElementById(tabName).classList.add('active');
  event.target.classList.add('active');
  
  // Load tab-specific data
  if (tabName === 'users') {
    loadUsers();
  }
}

function loadUsers() {
  const tbody = document.querySelector('#usersTable tbody');
  tbody.innerHTML = '';
  
  users.forEach(user => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${user.username}</td>
      <td>${user.fullName}</td>
      <td>${user.email}</td>
      <td>${user.role}</td>
      <td>${user.department}</td>
      <td><span class="status-${user.status}">${user.status}</span></td>
      <td>${user.lastLogin}</td>
      <td>
        <button class="btn btn-warning" onclick="editUser(${user.id})">‚úèÔ∏è</button>
        <button class="btn btn-danger" onclick="deleteUser(${user.id})">üóëÔ∏è</button>
        <button class="btn btn-info" onclick="resetPassword(${user.id})">üîë</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
  
  document.getElementById('activeUsers').textContent = users.filter(u => u.status === 'active').length;
}

function saveUser(e) {
  e.preventDefault();
  const user = {
    id: Date.now(),
    username: document.getElementById('userUsername').value,
    fullName: document.getElementById('userFullName').value,
    email: document.getElementById('userEmail').value,
    role: document.getElementById('userRole').value,
    department: document.getElementById('userDepartment').value,
    status: 'active',
    lastLogin: 'Never',
    timestamp: new Date().toISOString()
  };
  
  users.push(user);
  localStorage.setItem('adminUsers', JSON.stringify(users));
  loadUsers();
  closeModal('addUser');
  e.target.reset();
}

function editUser(id) {
  const user = users.find(u => u.id === id);
  if (user) {
    document.getElementById('userUsername').value = user.username;
    document.getElementById('userFullName').value = user.fullName;
    document.getElementById('userEmail').value = user.email;
    document.getElementById('userRole').value = user.role;
    document.getElementById('userDepartment').value = user.department;
    openModal('addUser');
  }
}

function deleteUser(id) {
  if (confirm('Are you sure you want to delete this user?')) {
    users = users.filter(u => u.id !== id);
    localStorage.setItem('adminUsers', JSON.stringify(users));
    loadUsers();
  }
}

function resetPassword(id) {
  if (confirm('Reset password for this user?')) {
    alert('Password reset email sent to user.');
  }
}

function createBackup() {
  alert('Creating system backup... This would backup all data in production.');
  
  // Simulate backup process
  setTimeout(() => {
    alert('Backup completed successfully!');
  }, 2000);
}

// Initialize
document.addEventListener('DOMContentLoaded', function() {
  loadUsers();
});
</script>
</body>
</html>
